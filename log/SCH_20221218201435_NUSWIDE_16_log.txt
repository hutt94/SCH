2022-12-18 20:14:35,048 - INFO - --------------------------Current Settings--------------------------
2022-12-18 20:14:35,048 - INFO - EVAL = False
2022-12-18 20:14:35,048 - INFO - DATASET = NUSWIDE
2022-12-18 20:14:35,048 - INFO - CODE_LEN = 16
2022-12-18 20:14:35,048 - INFO - GPU_ID =  2
2022-12-18 20:14:35,048 - INFO - ALPHA = 1.0000
2022-12-18 20:14:35,048 - INFO - BETA = 1.0000
2022-12-18 20:14:35,048 - INFO - NUM_EPOCH = 120
2022-12-18 20:14:35,049 - INFO - BATCH_SIZE = 32
2022-12-18 20:14:35,049 - INFO - NUM_WORKERS = 8
2022-12-18 20:14:35,049 - INFO - EPOCH_INTERVAL = 2
2022-12-18 20:14:35,049 - INFO - EVAL_INTERVAL = 40
2022-12-18 20:14:35,049 - INFO - LR_IMG = 0.0050
2022-12-18 20:14:35,049 - INFO - LR_TXT = 0.0050
2022-12-18 20:14:35,049 - INFO - MOMENTUM = 0.7000
2022-12-18 20:14:35,049 - INFO - WEIGHT_DECAY = 0.0005
2022-12-18 20:14:35,049 - INFO - --------------------------------------------------------------------
2022-12-18 20:19:26,297 - INFO - ---------------------------Size------------------------
2022-12-18 20:19:26,298 - INFO - Training size: 10000, Test size: 2000
2022-12-18 20:19:30,738 - INFO - Epoch [1/120], alpha for ImgNet: 1.0000, alpha for TxtNet: 1.0000
2022-12-18 20:20:04,231 - INFO - Epoch [1/120], Iter [156/312] Loss1: 0.0247 Loss2: 0.4093 Total Loss: 0.4340
2022-12-18 20:20:36,074 - INFO - Epoch [1/120], Iter [312/312] Loss1: 0.0231 Loss2: 0.4020 Total Loss: 0.4250
2022-12-18 20:20:36,280 - INFO - Epoch [2/120], alpha for ImgNet: 1.4142, alpha for TxtNet: 1.4142
2022-12-18 20:21:09,353 - INFO - Epoch [2/120], Iter [156/312] Loss1: 0.0423 Loss2: 0.4084 Total Loss: 0.4506
2022-12-18 20:21:41,217 - INFO - Epoch [2/120], Iter [312/312] Loss1: 0.0446 Loss2: 0.3801 Total Loss: 0.4246
2022-12-18 20:21:41,464 - INFO - Epoch [3/120], alpha for ImgNet: 1.7321, alpha for TxtNet: 1.7321
2022-12-18 20:22:14,600 - INFO - Epoch [3/120], Iter [156/312] Loss1: 0.0584 Loss2: 0.4149 Total Loss: 0.4733
2022-12-18 20:22:46,437 - INFO - Epoch [3/120], Iter [312/312] Loss1: 0.0528 Loss2: 0.3839 Total Loss: 0.4367
2022-12-18 20:22:46,673 - INFO - Epoch [4/120], alpha for ImgNet: 2.0000, alpha for TxtNet: 2.0000
2022-12-18 20:23:20,033 - INFO - Epoch [4/120], Iter [156/312] Loss1: 0.0698 Loss2: 0.3633 Total Loss: 0.4331
2022-12-18 20:23:51,974 - INFO - Epoch [4/120], Iter [312/312] Loss1: 0.0583 Loss2: 0.3580 Total Loss: 0.4163
2022-12-18 20:23:52,247 - INFO - Epoch [5/120], alpha for ImgNet: 2.2361, alpha for TxtNet: 2.2361
2022-12-18 20:24:25,734 - INFO - Epoch [5/120], Iter [156/312] Loss1: 0.0789 Loss2: 0.3407 Total Loss: 0.4196
2022-12-18 20:24:57,789 - INFO - Epoch [5/120], Iter [312/312] Loss1: 0.0715 Loss2: 0.3339 Total Loss: 0.4054
2022-12-18 20:24:58,024 - INFO - Epoch [6/120], alpha for ImgNet: 2.4495, alpha for TxtNet: 2.4495
2022-12-18 20:25:31,565 - INFO - Epoch [6/120], Iter [156/312] Loss1: 0.0769 Loss2: 0.3365 Total Loss: 0.4133
2022-12-18 20:26:03,494 - INFO - Epoch [6/120], Iter [312/312] Loss1: 0.0652 Loss2: 0.3581 Total Loss: 0.4233
2022-12-18 20:26:03,758 - INFO - Epoch [7/120], alpha for ImgNet: 2.6458, alpha for TxtNet: 2.6458
2022-12-18 20:26:36,964 - INFO - Epoch [7/120], Iter [156/312] Loss1: 0.0782 Loss2: 0.3471 Total Loss: 0.4253
2022-12-18 20:27:08,941 - INFO - Epoch [7/120], Iter [312/312] Loss1: 0.0694 Loss2: 0.3657 Total Loss: 0.4351
2022-12-18 20:27:09,183 - INFO - Epoch [8/120], alpha for ImgNet: 2.8284, alpha for TxtNet: 2.8284
2022-12-18 20:27:42,408 - INFO - Epoch [8/120], Iter [156/312] Loss1: 0.0677 Loss2: 0.3524 Total Loss: 0.4202
2022-12-18 20:28:14,201 - INFO - Epoch [8/120], Iter [312/312] Loss1: 0.0871 Loss2: 0.3245 Total Loss: 0.4117
2022-12-18 20:28:14,461 - INFO - Epoch [9/120], alpha for ImgNet: 3.0000, alpha for TxtNet: 3.0000
2022-12-18 20:28:47,535 - INFO - Epoch [9/120], Iter [156/312] Loss1: 0.0681 Loss2: 0.3116 Total Loss: 0.3797
2022-12-18 20:29:19,363 - INFO - Epoch [9/120], Iter [312/312] Loss1: 0.0836 Loss2: 0.3277 Total Loss: 0.4113
2022-12-18 20:29:19,594 - INFO - Epoch [10/120], alpha for ImgNet: 3.1623, alpha for TxtNet: 3.1623
2022-12-18 20:29:52,820 - INFO - Epoch [10/120], Iter [156/312] Loss1: 0.0897 Loss2: 0.2995 Total Loss: 0.3891
2022-12-18 20:30:24,755 - INFO - Epoch [10/120], Iter [312/312] Loss1: 0.0922 Loss2: 0.2992 Total Loss: 0.3914
2022-12-18 20:30:24,977 - INFO - Epoch [11/120], alpha for ImgNet: 3.3166, alpha for TxtNet: 3.3166
2022-12-18 20:30:58,232 - INFO - Epoch [11/120], Iter [156/312] Loss1: 0.0631 Loss2: 0.3201 Total Loss: 0.3832
2022-12-18 20:31:30,058 - INFO - Epoch [11/120], Iter [312/312] Loss1: 0.1090 Loss2: 0.2983 Total Loss: 0.4073
2022-12-18 20:31:30,276 - INFO - Epoch [12/120], alpha for ImgNet: 3.4641, alpha for TxtNet: 3.4641
2022-12-18 20:32:03,459 - INFO - Epoch [12/120], Iter [156/312] Loss1: 0.0920 Loss2: 0.2844 Total Loss: 0.3764
2022-12-18 20:32:35,290 - INFO - Epoch [12/120], Iter [312/312] Loss1: 0.0656 Loss2: 0.3029 Total Loss: 0.3685
2022-12-18 20:32:35,530 - INFO - Epoch [13/120], alpha for ImgNet: 3.6056, alpha for TxtNet: 3.6056
2022-12-18 20:33:08,701 - INFO - Epoch [13/120], Iter [156/312] Loss1: 0.1005 Loss2: 0.3101 Total Loss: 0.4106
2022-12-18 20:33:40,670 - INFO - Epoch [13/120], Iter [312/312] Loss1: 0.1292 Loss2: 0.2847 Total Loss: 0.4139
2022-12-18 20:33:40,895 - INFO - Epoch [14/120], alpha for ImgNet: 3.7417, alpha for TxtNet: 3.7417
2022-12-18 20:34:14,131 - INFO - Epoch [14/120], Iter [156/312] Loss1: 0.0954 Loss2: 0.2890 Total Loss: 0.3843
2022-12-18 20:34:45,794 - INFO - Epoch [14/120], Iter [312/312] Loss1: 0.0831 Loss2: 0.2753 Total Loss: 0.3584
2022-12-18 20:34:46,016 - INFO - Epoch [15/120], alpha for ImgNet: 3.8730, alpha for TxtNet: 3.8730
2022-12-18 20:35:19,082 - INFO - Epoch [15/120], Iter [156/312] Loss1: 0.0766 Loss2: 0.2928 Total Loss: 0.3693
2022-12-18 20:35:50,769 - INFO - Epoch [15/120], Iter [312/312] Loss1: 0.0826 Loss2: 0.2715 Total Loss: 0.3541
2022-12-18 20:35:51,000 - INFO - Epoch [16/120], alpha for ImgNet: 4.0000, alpha for TxtNet: 4.0000
2022-12-18 20:36:24,107 - INFO - Epoch [16/120], Iter [156/312] Loss1: 0.1159 Loss2: 0.2722 Total Loss: 0.3880
2022-12-18 20:36:55,686 - INFO - Epoch [16/120], Iter [312/312] Loss1: 0.1165 Loss2: 0.2734 Total Loss: 0.3898
2022-12-18 20:36:55,892 - INFO - Epoch [17/120], alpha for ImgNet: 4.1231, alpha for TxtNet: 4.1231
2022-12-18 20:37:28,900 - INFO - Epoch [17/120], Iter [156/312] Loss1: 0.0937 Loss2: 0.2652 Total Loss: 0.3589
2022-12-18 20:38:00,465 - INFO - Epoch [17/120], Iter [312/312] Loss1: 0.1062 Loss2: 0.2935 Total Loss: 0.3997
2022-12-18 20:38:00,699 - INFO - Epoch [18/120], alpha for ImgNet: 4.2426, alpha for TxtNet: 4.2426
2022-12-18 20:38:33,687 - INFO - Epoch [18/120], Iter [156/312] Loss1: 0.1023 Loss2: 0.2811 Total Loss: 0.3834
2022-12-18 20:39:05,266 - INFO - Epoch [18/120], Iter [312/312] Loss1: 0.1072 Loss2: 0.2695 Total Loss: 0.3768
2022-12-18 20:39:05,472 - INFO - Epoch [19/120], alpha for ImgNet: 4.3589, alpha for TxtNet: 4.3589
2022-12-18 20:39:38,500 - INFO - Epoch [19/120], Iter [156/312] Loss1: 0.0977 Loss2: 0.2841 Total Loss: 0.3817
2022-12-18 20:40:10,054 - INFO - Epoch [19/120], Iter [312/312] Loss1: 0.0917 Loss2: 0.2724 Total Loss: 0.3641
2022-12-18 20:40:10,251 - INFO - Epoch [20/120], alpha for ImgNet: 4.4721, alpha for TxtNet: 4.4721
2022-12-18 20:40:43,197 - INFO - Epoch [20/120], Iter [156/312] Loss1: 0.0763 Loss2: 0.2574 Total Loss: 0.3338
2022-12-18 20:41:14,808 - INFO - Epoch [20/120], Iter [312/312] Loss1: 0.1326 Loss2: 0.2620 Total Loss: 0.3946
2022-12-18 20:41:15,032 - INFO - Epoch [21/120], alpha for ImgNet: 4.5826, alpha for TxtNet: 4.5826
2022-12-18 20:41:48,052 - INFO - Epoch [21/120], Iter [156/312] Loss1: 0.1125 Loss2: 0.2768 Total Loss: 0.3893
2022-12-18 20:42:19,621 - INFO - Epoch [21/120], Iter [312/312] Loss1: 0.1365 Loss2: 0.2534 Total Loss: 0.3898
2022-12-18 20:42:19,813 - INFO - Epoch [22/120], alpha for ImgNet: 4.6904, alpha for TxtNet: 4.6904
2022-12-18 20:42:52,846 - INFO - Epoch [22/120], Iter [156/312] Loss1: 0.1256 Loss2: 0.2454 Total Loss: 0.3710
2022-12-18 20:43:24,486 - INFO - Epoch [22/120], Iter [312/312] Loss1: 0.1251 Loss2: 0.2334 Total Loss: 0.3585
2022-12-18 20:43:24,732 - INFO - Epoch [23/120], alpha for ImgNet: 4.7958, alpha for TxtNet: 4.7958
2022-12-18 20:43:57,736 - INFO - Epoch [23/120], Iter [156/312] Loss1: 0.1037 Loss2: 0.2601 Total Loss: 0.3639
2022-12-18 20:44:29,294 - INFO - Epoch [23/120], Iter [312/312] Loss1: 0.0894 Loss2: 0.2699 Total Loss: 0.3592
2022-12-18 20:44:29,535 - INFO - Epoch [24/120], alpha for ImgNet: 4.8990, alpha for TxtNet: 4.8990
2022-12-18 20:45:02,539 - INFO - Epoch [24/120], Iter [156/312] Loss1: 0.1046 Loss2: 0.2641 Total Loss: 0.3686
2022-12-18 20:45:34,120 - INFO - Epoch [24/120], Iter [312/312] Loss1: 0.0997 Loss2: 0.2566 Total Loss: 0.3564
2022-12-18 20:45:34,342 - INFO - Epoch [25/120], alpha for ImgNet: 5.0000, alpha for TxtNet: 5.0000
2022-12-18 20:46:07,435 - INFO - Epoch [25/120], Iter [156/312] Loss1: 0.1129 Loss2: 0.2174 Total Loss: 0.3303
2022-12-18 20:46:39,020 - INFO - Epoch [25/120], Iter [312/312] Loss1: 0.1065 Loss2: 0.2528 Total Loss: 0.3593
2022-12-18 20:46:39,249 - INFO - Epoch [26/120], alpha for ImgNet: 5.0990, alpha for TxtNet: 5.0990
2022-12-18 20:47:12,380 - INFO - Epoch [26/120], Iter [156/312] Loss1: 0.0781 Loss2: 0.2705 Total Loss: 0.3486
2022-12-18 20:47:44,001 - INFO - Epoch [26/120], Iter [312/312] Loss1: 0.1199 Loss2: 0.2195 Total Loss: 0.3394
2022-12-18 20:47:44,213 - INFO - Epoch [27/120], alpha for ImgNet: 5.1962, alpha for TxtNet: 5.1962
2022-12-18 20:48:17,321 - INFO - Epoch [27/120], Iter [156/312] Loss1: 0.1075 Loss2: 0.2633 Total Loss: 0.3708
2022-12-18 20:48:49,153 - INFO - Epoch [27/120], Iter [312/312] Loss1: 0.1059 Loss2: 0.2599 Total Loss: 0.3658
2022-12-18 20:48:49,380 - INFO - Epoch [28/120], alpha for ImgNet: 5.2915, alpha for TxtNet: 5.2915
2022-12-18 20:49:22,551 - INFO - Epoch [28/120], Iter [156/312] Loss1: 0.1082 Loss2: 0.2776 Total Loss: 0.3858
2022-12-18 20:49:54,180 - INFO - Epoch [28/120], Iter [312/312] Loss1: 0.1151 Loss2: 0.2315 Total Loss: 0.3466
2022-12-18 20:49:54,438 - INFO - Epoch [29/120], alpha for ImgNet: 5.3852, alpha for TxtNet: 5.3852
2022-12-18 20:50:27,504 - INFO - Epoch [29/120], Iter [156/312] Loss1: 0.0905 Loss2: 0.2322 Total Loss: 0.3227
2022-12-18 20:50:59,099 - INFO - Epoch [29/120], Iter [312/312] Loss1: 0.1245 Loss2: 0.2775 Total Loss: 0.4020
2022-12-18 20:50:59,294 - INFO - Epoch [30/120], alpha for ImgNet: 5.4772, alpha for TxtNet: 5.4772
2022-12-18 20:51:32,250 - INFO - Epoch [30/120], Iter [156/312] Loss1: 0.1519 Loss2: 0.2239 Total Loss: 0.3759
2022-12-18 20:52:03,747 - INFO - Epoch [30/120], Iter [312/312] Loss1: 0.1146 Loss2: 0.2702 Total Loss: 0.3848
2022-12-18 20:52:03,965 - INFO - Epoch [31/120], alpha for ImgNet: 5.5678, alpha for TxtNet: 5.5678
2022-12-18 20:52:36,917 - INFO - Epoch [31/120], Iter [156/312] Loss1: 0.1042 Loss2: 0.2413 Total Loss: 0.3455
2022-12-18 20:53:08,525 - INFO - Epoch [31/120], Iter [312/312] Loss1: 0.1073 Loss2: 0.2594 Total Loss: 0.3667
2022-12-18 20:53:08,748 - INFO - Epoch [32/120], alpha for ImgNet: 5.6569, alpha for TxtNet: 5.6569
2022-12-18 20:53:41,705 - INFO - Epoch [32/120], Iter [156/312] Loss1: 0.1184 Loss2: 0.2171 Total Loss: 0.3355
2022-12-18 20:54:13,253 - INFO - Epoch [32/120], Iter [312/312] Loss1: 0.1027 Loss2: 0.2693 Total Loss: 0.3721
2022-12-18 20:54:13,524 - INFO - Epoch [33/120], alpha for ImgNet: 5.7446, alpha for TxtNet: 5.7446
2022-12-18 20:54:46,602 - INFO - Epoch [33/120], Iter [156/312] Loss1: 0.1372 Loss2: 0.2050 Total Loss: 0.3422
2022-12-18 20:55:18,394 - INFO - Epoch [33/120], Iter [312/312] Loss1: 0.0808 Loss2: 0.2256 Total Loss: 0.3064
2022-12-18 20:55:18,634 - INFO - Epoch [34/120], alpha for ImgNet: 5.8310, alpha for TxtNet: 5.8310
2022-12-18 20:55:52,109 - INFO - Epoch [34/120], Iter [156/312] Loss1: 0.1051 Loss2: 0.2591 Total Loss: 0.3643
2022-12-18 20:56:24,012 - INFO - Epoch [34/120], Iter [312/312] Loss1: 0.0962 Loss2: 0.2522 Total Loss: 0.3483
2022-12-18 20:56:24,248 - INFO - Epoch [35/120], alpha for ImgNet: 5.9161, alpha for TxtNet: 5.9161
2022-12-18 20:56:57,742 - INFO - Epoch [35/120], Iter [156/312] Loss1: 0.1044 Loss2: 0.2236 Total Loss: 0.3280
2022-12-18 20:57:29,600 - INFO - Epoch [35/120], Iter [312/312] Loss1: 0.1024 Loss2: 0.2624 Total Loss: 0.3648
2022-12-18 20:57:29,832 - INFO - Epoch [36/120], alpha for ImgNet: 6.0000, alpha for TxtNet: 6.0000
2022-12-18 20:58:03,394 - INFO - Epoch [36/120], Iter [156/312] Loss1: 0.1048 Loss2: 0.2376 Total Loss: 0.3424
2022-12-18 20:58:35,319 - INFO - Epoch [36/120], Iter [312/312] Loss1: 0.1046 Loss2: 0.2331 Total Loss: 0.3376
2022-12-18 20:58:35,556 - INFO - Epoch [37/120], alpha for ImgNet: 6.0828, alpha for TxtNet: 6.0828
2022-12-18 20:59:08,951 - INFO - Epoch [37/120], Iter [156/312] Loss1: 0.1432 Loss2: 0.2274 Total Loss: 0.3706
2022-12-18 20:59:40,824 - INFO - Epoch [37/120], Iter [312/312] Loss1: 0.1065 Loss2: 0.2151 Total Loss: 0.3216
2022-12-18 20:59:41,076 - INFO - Epoch [38/120], alpha for ImgNet: 6.1644, alpha for TxtNet: 6.1644
2022-12-18 21:00:14,434 - INFO - Epoch [38/120], Iter [156/312] Loss1: 0.1165 Loss2: 0.1728 Total Loss: 0.2893
2022-12-18 21:00:46,135 - INFO - Epoch [38/120], Iter [312/312] Loss1: 0.1261 Loss2: 0.2237 Total Loss: 0.3497
2022-12-18 21:00:46,369 - INFO - Epoch [39/120], alpha for ImgNet: 6.2450, alpha for TxtNet: 6.2450
2022-12-18 21:01:19,634 - INFO - Epoch [39/120], Iter [156/312] Loss1: 0.1237 Loss2: 0.2176 Total Loss: 0.3414
2022-12-18 21:01:51,436 - INFO - Epoch [39/120], Iter [312/312] Loss1: 0.1146 Loss2: 0.2132 Total Loss: 0.3278
2022-12-18 21:01:51,720 - INFO - Epoch [40/120], alpha for ImgNet: 6.3246, alpha for TxtNet: 6.3246
2022-12-18 21:02:25,242 - INFO - Epoch [40/120], Iter [156/312] Loss1: 0.1335 Loss2: 0.2002 Total Loss: 0.3337
2022-12-18 21:02:57,287 - INFO - Epoch [40/120], Iter [312/312] Loss1: 0.1174 Loss2: 0.2167 Total Loss: 0.3342
2022-12-18 21:11:18,107 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-18 21:11:18,108 - INFO - MAP of Image to Text: 0.851, MAP of Text to Image: 0.797
2022-12-18 21:11:18,108 - INFO - --------------------------------------------------------------------
2022-12-18 21:12:25,740 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-18 21:12:25,741 - INFO - MAP of Image to Text: 0.667, MAP of Text to Image: 0.708
2022-12-18 21:12:25,741 - INFO - --------------------------------------------------------------------
2022-12-18 21:12:29,777 - INFO - **********Save the trained model successfully.**********
2022-12-18 21:12:29,777 - INFO - #########is best:1.3756 #########
2022-12-18 21:12:30,104 - INFO - Epoch [41/120], alpha for ImgNet: 6.4031, alpha for TxtNet: 6.4031
2022-12-18 21:13:03,414 - INFO - Epoch [41/120], Iter [156/312] Loss1: 0.1041 Loss2: 0.2260 Total Loss: 0.3301
2022-12-18 21:13:35,135 - INFO - Epoch [41/120], Iter [312/312] Loss1: 0.0960 Loss2: 0.2333 Total Loss: 0.3293
2022-12-18 21:13:35,364 - INFO - Epoch [42/120], alpha for ImgNet: 6.4807, alpha for TxtNet: 6.4807
2022-12-18 21:14:08,364 - INFO - Epoch [42/120], Iter [156/312] Loss1: 0.0810 Loss2: 0.1942 Total Loss: 0.2751
2022-12-18 21:14:40,187 - INFO - Epoch [42/120], Iter [312/312] Loss1: 0.1079 Loss2: 0.2531 Total Loss: 0.3610
2022-12-18 21:14:40,442 - INFO - Epoch [43/120], alpha for ImgNet: 6.5574, alpha for TxtNet: 6.5574
2022-12-18 21:15:13,741 - INFO - Epoch [43/120], Iter [156/312] Loss1: 0.1250 Loss2: 0.2158 Total Loss: 0.3408
2022-12-18 21:15:45,626 - INFO - Epoch [43/120], Iter [312/312] Loss1: 0.1030 Loss2: 0.2195 Total Loss: 0.3224
2022-12-18 21:15:45,864 - INFO - Epoch [44/120], alpha for ImgNet: 6.6332, alpha for TxtNet: 6.6332
2022-12-18 21:16:19,339 - INFO - Epoch [44/120], Iter [156/312] Loss1: 0.0872 Loss2: 0.2222 Total Loss: 0.3094
2022-12-18 21:16:51,222 - INFO - Epoch [44/120], Iter [312/312] Loss1: 0.1068 Loss2: 0.2064 Total Loss: 0.3132
2022-12-18 21:16:51,440 - INFO - Epoch [45/120], alpha for ImgNet: 6.7082, alpha for TxtNet: 6.7082
2022-12-18 21:17:24,735 - INFO - Epoch [45/120], Iter [156/312] Loss1: 0.1204 Loss2: 0.2598 Total Loss: 0.3801
2022-12-18 21:17:56,592 - INFO - Epoch [45/120], Iter [312/312] Loss1: 0.1206 Loss2: 0.2184 Total Loss: 0.3390
2022-12-18 21:17:56,868 - INFO - Epoch [46/120], alpha for ImgNet: 6.7823, alpha for TxtNet: 6.7823
2022-12-18 21:18:30,236 - INFO - Epoch [46/120], Iter [156/312] Loss1: 0.0986 Loss2: 0.2696 Total Loss: 0.3682
2022-12-18 21:19:02,110 - INFO - Epoch [46/120], Iter [312/312] Loss1: 0.1360 Loss2: 0.2168 Total Loss: 0.3528
2022-12-18 21:19:02,330 - INFO - Epoch [47/120], alpha for ImgNet: 6.8557, alpha for TxtNet: 6.8557
2022-12-18 21:19:35,538 - INFO - Epoch [47/120], Iter [156/312] Loss1: 0.0921 Loss2: 0.2304 Total Loss: 0.3226
2022-12-18 21:20:07,340 - INFO - Epoch [47/120], Iter [312/312] Loss1: 0.1074 Loss2: 0.2133 Total Loss: 0.3207
2022-12-18 21:20:07,574 - INFO - Epoch [48/120], alpha for ImgNet: 6.9282, alpha for TxtNet: 6.9282
2022-12-18 21:20:40,858 - INFO - Epoch [48/120], Iter [156/312] Loss1: 0.1175 Loss2: 0.2300 Total Loss: 0.3475
2022-12-18 21:21:12,724 - INFO - Epoch [48/120], Iter [312/312] Loss1: 0.1141 Loss2: 0.2239 Total Loss: 0.3380
2022-12-18 21:21:12,954 - INFO - Epoch [49/120], alpha for ImgNet: 7.0000, alpha for TxtNet: 7.0000
2022-12-18 21:21:46,318 - INFO - Epoch [49/120], Iter [156/312] Loss1: 0.0929 Loss2: 0.2071 Total Loss: 0.3000
2022-12-18 21:22:18,093 - INFO - Epoch [49/120], Iter [312/312] Loss1: 0.1176 Loss2: 0.2313 Total Loss: 0.3489
2022-12-18 21:22:18,353 - INFO - Epoch [50/120], alpha for ImgNet: 7.0711, alpha for TxtNet: 7.0711
2022-12-18 21:22:51,749 - INFO - Epoch [50/120], Iter [156/312] Loss1: 0.1098 Loss2: 0.2099 Total Loss: 0.3197
2022-12-18 21:23:23,435 - INFO - Epoch [50/120], Iter [312/312] Loss1: 0.1191 Loss2: 0.2057 Total Loss: 0.3247
2022-12-18 21:23:23,674 - INFO - Epoch [51/120], alpha for ImgNet: 7.1414, alpha for TxtNet: 7.1414
2022-12-18 21:23:56,897 - INFO - Epoch [51/120], Iter [156/312] Loss1: 0.1524 Loss2: 0.1918 Total Loss: 0.3441
2022-12-18 21:24:28,639 - INFO - Epoch [51/120], Iter [312/312] Loss1: 0.1173 Loss2: 0.1947 Total Loss: 0.3120
2022-12-18 21:24:28,878 - INFO - Epoch [52/120], alpha for ImgNet: 7.2111, alpha for TxtNet: 7.2111
2022-12-18 21:25:02,031 - INFO - Epoch [52/120], Iter [156/312] Loss1: 0.0959 Loss2: 0.2356 Total Loss: 0.3315
2022-12-18 21:25:33,786 - INFO - Epoch [52/120], Iter [312/312] Loss1: 0.1253 Loss2: 0.1951 Total Loss: 0.3204
2022-12-18 21:25:34,023 - INFO - Epoch [53/120], alpha for ImgNet: 7.2801, alpha for TxtNet: 7.2801
2022-12-18 21:26:07,325 - INFO - Epoch [53/120], Iter [156/312] Loss1: 0.1197 Loss2: 0.2252 Total Loss: 0.3449
2022-12-18 21:26:38,999 - INFO - Epoch [53/120], Iter [312/312] Loss1: 0.1350 Loss2: 0.2162 Total Loss: 0.3513
2022-12-18 21:26:39,241 - INFO - Epoch [54/120], alpha for ImgNet: 7.3485, alpha for TxtNet: 7.3485
2022-12-18 21:27:12,608 - INFO - Epoch [54/120], Iter [156/312] Loss1: 0.1012 Loss2: 0.1855 Total Loss: 0.2867
2022-12-18 21:27:44,425 - INFO - Epoch [54/120], Iter [312/312] Loss1: 0.1306 Loss2: 0.2118 Total Loss: 0.3424
2022-12-18 21:27:44,650 - INFO - Epoch [55/120], alpha for ImgNet: 7.4162, alpha for TxtNet: 7.4162
2022-12-18 21:28:18,043 - INFO - Epoch [55/120], Iter [156/312] Loss1: 0.1024 Loss2: 0.2161 Total Loss: 0.3185
2022-12-18 21:28:49,757 - INFO - Epoch [55/120], Iter [312/312] Loss1: 0.1304 Loss2: 0.2125 Total Loss: 0.3429
2022-12-18 21:28:49,970 - INFO - Epoch [56/120], alpha for ImgNet: 7.4833, alpha for TxtNet: 7.4833
2022-12-18 21:29:23,265 - INFO - Epoch [56/120], Iter [156/312] Loss1: 0.1063 Loss2: 0.2007 Total Loss: 0.3070
2022-12-18 21:29:54,979 - INFO - Epoch [56/120], Iter [312/312] Loss1: 0.1474 Loss2: 0.2064 Total Loss: 0.3538
2022-12-18 21:29:55,225 - INFO - Epoch [57/120], alpha for ImgNet: 7.5498, alpha for TxtNet: 7.5498
2022-12-18 21:30:28,479 - INFO - Epoch [57/120], Iter [156/312] Loss1: 0.0841 Loss2: 0.2079 Total Loss: 0.2920
2022-12-18 21:31:00,231 - INFO - Epoch [57/120], Iter [312/312] Loss1: 0.1048 Loss2: 0.1963 Total Loss: 0.3011
2022-12-18 21:31:00,488 - INFO - Epoch [58/120], alpha for ImgNet: 7.6158, alpha for TxtNet: 7.6158
2022-12-18 21:31:33,697 - INFO - Epoch [58/120], Iter [156/312] Loss1: 0.1376 Loss2: 0.2067 Total Loss: 0.3443
2022-12-18 21:32:05,521 - INFO - Epoch [58/120], Iter [312/312] Loss1: 0.1071 Loss2: 0.2227 Total Loss: 0.3299
2022-12-18 21:32:05,733 - INFO - Epoch [59/120], alpha for ImgNet: 7.6811, alpha for TxtNet: 7.6811
2022-12-18 21:32:38,966 - INFO - Epoch [59/120], Iter [156/312] Loss1: 0.1207 Loss2: 0.2037 Total Loss: 0.3243
2022-12-18 21:33:10,621 - INFO - Epoch [59/120], Iter [312/312] Loss1: 0.1467 Loss2: 0.1996 Total Loss: 0.3463
2022-12-18 21:33:10,860 - INFO - Epoch [60/120], alpha for ImgNet: 7.7460, alpha for TxtNet: 7.7460
2022-12-18 21:33:44,003 - INFO - Epoch [60/120], Iter [156/312] Loss1: 0.0930 Loss2: 0.2032 Total Loss: 0.2962
2022-12-18 21:34:15,660 - INFO - Epoch [60/120], Iter [312/312] Loss1: 0.1244 Loss2: 0.2141 Total Loss: 0.3385
2022-12-18 21:34:15,934 - INFO - Epoch [61/120], alpha for ImgNet: 7.8102, alpha for TxtNet: 7.8102
2022-12-18 21:34:49,095 - INFO - Epoch [61/120], Iter [156/312] Loss1: 0.1110 Loss2: 0.1970 Total Loss: 0.3080
2022-12-18 21:35:21,342 - INFO - Epoch [61/120], Iter [312/312] Loss1: 0.1428 Loss2: 0.1945 Total Loss: 0.3374
2022-12-18 21:35:21,592 - INFO - Epoch [62/120], alpha for ImgNet: 7.8740, alpha for TxtNet: 7.8740
2022-12-18 21:35:54,803 - INFO - Epoch [62/120], Iter [156/312] Loss1: 0.0724 Loss2: 0.1852 Total Loss: 0.2576
2022-12-18 21:36:26,490 - INFO - Epoch [62/120], Iter [312/312] Loss1: 0.1098 Loss2: 0.1828 Total Loss: 0.2927
2022-12-18 21:36:26,729 - INFO - Epoch [63/120], alpha for ImgNet: 7.9373, alpha for TxtNet: 7.9373
2022-12-18 21:37:00,012 - INFO - Epoch [63/120], Iter [156/312] Loss1: 0.1310 Loss2: 0.1956 Total Loss: 0.3266
2022-12-18 21:37:31,755 - INFO - Epoch [63/120], Iter [312/312] Loss1: 0.1122 Loss2: 0.2150 Total Loss: 0.3273
2022-12-18 21:37:31,974 - INFO - Epoch [64/120], alpha for ImgNet: 8.0000, alpha for TxtNet: 8.0000
2022-12-18 21:38:05,191 - INFO - Epoch [64/120], Iter [156/312] Loss1: 0.1254 Loss2: 0.1838 Total Loss: 0.3092
2022-12-18 21:38:36,874 - INFO - Epoch [64/120], Iter [312/312] Loss1: 0.1141 Loss2: 0.2074 Total Loss: 0.3215
2022-12-18 21:38:37,116 - INFO - Epoch [65/120], alpha for ImgNet: 8.0623, alpha for TxtNet: 8.0623
2022-12-18 21:39:10,344 - INFO - Epoch [65/120], Iter [156/312] Loss1: 0.0984 Loss2: 0.2270 Total Loss: 0.3254
2022-12-18 21:39:42,029 - INFO - Epoch [65/120], Iter [312/312] Loss1: 0.1208 Loss2: 0.2131 Total Loss: 0.3340
2022-12-18 21:39:42,239 - INFO - Epoch [66/120], alpha for ImgNet: 8.1240, alpha for TxtNet: 8.1240
2022-12-18 21:40:15,483 - INFO - Epoch [66/120], Iter [156/312] Loss1: 0.0943 Loss2: 0.1932 Total Loss: 0.2875
2022-12-18 21:40:47,195 - INFO - Epoch [66/120], Iter [312/312] Loss1: 0.1088 Loss2: 0.1787 Total Loss: 0.2875
2022-12-18 21:40:47,415 - INFO - Epoch [67/120], alpha for ImgNet: 8.1854, alpha for TxtNet: 8.1854
2022-12-18 21:41:20,501 - INFO - Epoch [67/120], Iter [156/312] Loss1: 0.1472 Loss2: 0.2189 Total Loss: 0.3661
2022-12-18 21:41:52,113 - INFO - Epoch [67/120], Iter [312/312] Loss1: 0.1143 Loss2: 0.1913 Total Loss: 0.3056
2022-12-18 21:41:52,323 - INFO - Epoch [68/120], alpha for ImgNet: 8.2462, alpha for TxtNet: 8.2462
2022-12-18 21:42:25,431 - INFO - Epoch [68/120], Iter [156/312] Loss1: 0.1153 Loss2: 0.2077 Total Loss: 0.3230
2022-12-18 21:42:57,158 - INFO - Epoch [68/120], Iter [312/312] Loss1: 0.0817 Loss2: 0.1916 Total Loss: 0.2733
2022-12-18 21:42:57,366 - INFO - Epoch [69/120], alpha for ImgNet: 8.3066, alpha for TxtNet: 8.3066
2022-12-18 21:43:30,430 - INFO - Epoch [69/120], Iter [156/312] Loss1: 0.0913 Loss2: 0.2169 Total Loss: 0.3082
2022-12-18 21:44:02,125 - INFO - Epoch [69/120], Iter [312/312] Loss1: 0.1082 Loss2: 0.1982 Total Loss: 0.3064
2022-12-18 21:44:02,372 - INFO - Epoch [70/120], alpha for ImgNet: 8.3666, alpha for TxtNet: 8.3666
2022-12-18 21:44:35,460 - INFO - Epoch [70/120], Iter [156/312] Loss1: 0.1206 Loss2: 0.1874 Total Loss: 0.3080
2022-12-18 21:45:07,113 - INFO - Epoch [70/120], Iter [312/312] Loss1: 0.1066 Loss2: 0.1865 Total Loss: 0.2931
2022-12-18 21:45:07,377 - INFO - Epoch [71/120], alpha for ImgNet: 8.4261, alpha for TxtNet: 8.4261
2022-12-18 21:45:40,608 - INFO - Epoch [71/120], Iter [156/312] Loss1: 0.1121 Loss2: 0.1881 Total Loss: 0.3002
2022-12-18 21:46:12,240 - INFO - Epoch [71/120], Iter [312/312] Loss1: 0.1143 Loss2: 0.2168 Total Loss: 0.3310
2022-12-18 21:46:12,485 - INFO - Epoch [72/120], alpha for ImgNet: 8.4853, alpha for TxtNet: 8.4853
2022-12-18 21:46:45,779 - INFO - Epoch [72/120], Iter [156/312] Loss1: 0.1146 Loss2: 0.1847 Total Loss: 0.2993
2022-12-18 21:47:17,396 - INFO - Epoch [72/120], Iter [312/312] Loss1: 0.1085 Loss2: 0.1827 Total Loss: 0.2912
2022-12-18 21:47:17,598 - INFO - Epoch [73/120], alpha for ImgNet: 8.5440, alpha for TxtNet: 8.5440
2022-12-18 21:47:50,781 - INFO - Epoch [73/120], Iter [156/312] Loss1: 0.1230 Loss2: 0.2002 Total Loss: 0.3232
2022-12-18 21:48:22,431 - INFO - Epoch [73/120], Iter [312/312] Loss1: 0.0858 Loss2: 0.1850 Total Loss: 0.2709
2022-12-18 21:48:22,668 - INFO - Epoch [74/120], alpha for ImgNet: 8.6023, alpha for TxtNet: 8.6023
2022-12-18 21:48:55,820 - INFO - Epoch [74/120], Iter [156/312] Loss1: 0.0911 Loss2: 0.1857 Total Loss: 0.2768
2022-12-18 21:49:27,546 - INFO - Epoch [74/120], Iter [312/312] Loss1: 0.1043 Loss2: 0.1944 Total Loss: 0.2988
2022-12-18 21:49:27,793 - INFO - Epoch [75/120], alpha for ImgNet: 8.6603, alpha for TxtNet: 8.6603
2022-12-18 21:50:00,918 - INFO - Epoch [75/120], Iter [156/312] Loss1: 0.1145 Loss2: 0.1985 Total Loss: 0.3130
2022-12-18 21:50:32,565 - INFO - Epoch [75/120], Iter [312/312] Loss1: 0.1110 Loss2: 0.1976 Total Loss: 0.3087
2022-12-18 21:50:32,758 - INFO - Epoch [76/120], alpha for ImgNet: 8.7178, alpha for TxtNet: 8.7178
2022-12-18 21:51:05,783 - INFO - Epoch [76/120], Iter [156/312] Loss1: 0.1181 Loss2: 0.2061 Total Loss: 0.3242
2022-12-18 21:51:37,446 - INFO - Epoch [76/120], Iter [312/312] Loss1: 0.1199 Loss2: 0.1978 Total Loss: 0.3177
2022-12-18 21:51:37,721 - INFO - Epoch [77/120], alpha for ImgNet: 8.7750, alpha for TxtNet: 8.7750
2022-12-18 21:52:10,977 - INFO - Epoch [77/120], Iter [156/312] Loss1: 0.1280 Loss2: 0.2189 Total Loss: 0.3469
2022-12-18 21:52:42,672 - INFO - Epoch [77/120], Iter [312/312] Loss1: 0.1434 Loss2: 0.1657 Total Loss: 0.3091
2022-12-18 21:52:42,905 - INFO - Epoch [78/120], alpha for ImgNet: 8.8318, alpha for TxtNet: 8.8318
2022-12-18 21:53:16,093 - INFO - Epoch [78/120], Iter [156/312] Loss1: 0.1371 Loss2: 0.2009 Total Loss: 0.3379
2022-12-18 21:53:47,753 - INFO - Epoch [78/120], Iter [312/312] Loss1: 0.0860 Loss2: 0.2049 Total Loss: 0.2908
2022-12-18 21:53:47,991 - INFO - Epoch [79/120], alpha for ImgNet: 8.8882, alpha for TxtNet: 8.8882
2022-12-18 21:54:21,250 - INFO - Epoch [79/120], Iter [156/312] Loss1: 0.1614 Loss2: 0.2037 Total Loss: 0.3651
2022-12-18 21:54:52,914 - INFO - Epoch [79/120], Iter [312/312] Loss1: 0.1150 Loss2: 0.1956 Total Loss: 0.3106
2022-12-18 21:54:53,137 - INFO - Epoch [80/120], alpha for ImgNet: 8.9443, alpha for TxtNet: 8.9443
2022-12-18 21:55:26,183 - INFO - Epoch [80/120], Iter [156/312] Loss1: 0.0884 Loss2: 0.2012 Total Loss: 0.2896
2022-12-18 21:55:57,867 - INFO - Epoch [80/120], Iter [312/312] Loss1: 0.1084 Loss2: 0.2004 Total Loss: 0.3088
2022-12-18 22:04:08,041 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-18 22:04:08,042 - INFO - MAP of Image to Text: 0.854, MAP of Text to Image: 0.798
2022-12-18 22:04:08,042 - INFO - --------------------------------------------------------------------
2022-12-18 22:05:13,116 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-18 22:05:13,117 - INFO - MAP of Image to Text: 0.683, MAP of Text to Image: 0.718
2022-12-18 22:05:13,117 - INFO - --------------------------------------------------------------------
2022-12-18 22:05:15,941 - INFO - **********Save the trained model successfully.**********
2022-12-18 22:05:15,941 - INFO - #########is best:1.4008 #########
2022-12-18 22:05:16,270 - INFO - Epoch [81/120], alpha for ImgNet: 9.0000, alpha for TxtNet: 9.0000
2022-12-18 22:05:49,326 - INFO - Epoch [81/120], Iter [156/312] Loss1: 0.1186 Loss2: 0.1971 Total Loss: 0.3158
2022-12-18 22:06:20,839 - INFO - Epoch [81/120], Iter [312/312] Loss1: 0.1006 Loss2: 0.1887 Total Loss: 0.2893
2022-12-18 22:06:21,046 - INFO - Epoch [82/120], alpha for ImgNet: 9.0554, alpha for TxtNet: 9.0554
2022-12-18 22:06:53,983 - INFO - Epoch [82/120], Iter [156/312] Loss1: 0.1126 Loss2: 0.1868 Total Loss: 0.2994
2022-12-18 22:07:25,547 - INFO - Epoch [82/120], Iter [312/312] Loss1: 0.1183 Loss2: 0.1648 Total Loss: 0.2831
2022-12-18 22:07:25,773 - INFO - Epoch [83/120], alpha for ImgNet: 9.1104, alpha for TxtNet: 9.1104
2022-12-18 22:07:58,989 - INFO - Epoch [83/120], Iter [156/312] Loss1: 0.0874 Loss2: 0.1830 Total Loss: 0.2704
2022-12-18 22:08:30,717 - INFO - Epoch [83/120], Iter [312/312] Loss1: 0.0974 Loss2: 0.1680 Total Loss: 0.2654
2022-12-18 22:08:30,966 - INFO - Epoch [84/120], alpha for ImgNet: 9.1652, alpha for TxtNet: 9.1652
2022-12-18 22:09:04,033 - INFO - Epoch [84/120], Iter [156/312] Loss1: 0.0859 Loss2: 0.1955 Total Loss: 0.2814
2022-12-18 22:09:35,742 - INFO - Epoch [84/120], Iter [312/312] Loss1: 0.1260 Loss2: 0.2089 Total Loss: 0.3349
2022-12-18 22:09:35,965 - INFO - Epoch [85/120], alpha for ImgNet: 9.2195, alpha for TxtNet: 9.2195
2022-12-18 22:10:09,170 - INFO - Epoch [85/120], Iter [156/312] Loss1: 0.1038 Loss2: 0.1846 Total Loss: 0.2884
2022-12-18 22:10:40,816 - INFO - Epoch [85/120], Iter [312/312] Loss1: 0.1065 Loss2: 0.1838 Total Loss: 0.2903
2022-12-18 22:10:41,090 - INFO - Epoch [86/120], alpha for ImgNet: 9.2736, alpha for TxtNet: 9.2736
2022-12-18 22:11:14,237 - INFO - Epoch [86/120], Iter [156/312] Loss1: 0.0877 Loss2: 0.1845 Total Loss: 0.2722
2022-12-18 22:11:45,927 - INFO - Epoch [86/120], Iter [312/312] Loss1: 0.1094 Loss2: 0.2161 Total Loss: 0.3255
2022-12-18 22:11:46,167 - INFO - Epoch [87/120], alpha for ImgNet: 9.3274, alpha for TxtNet: 9.3274
2022-12-18 22:12:19,191 - INFO - Epoch [87/120], Iter [156/312] Loss1: 0.1203 Loss2: 0.1975 Total Loss: 0.3178
2022-12-18 22:12:50,897 - INFO - Epoch [87/120], Iter [312/312] Loss1: 0.1027 Loss2: 0.2190 Total Loss: 0.3217
2022-12-18 22:12:51,122 - INFO - Epoch [88/120], alpha for ImgNet: 9.3808, alpha for TxtNet: 9.3808
2022-12-18 22:13:24,265 - INFO - Epoch [88/120], Iter [156/312] Loss1: 0.1184 Loss2: 0.1741 Total Loss: 0.2925
2022-12-18 22:13:55,913 - INFO - Epoch [88/120], Iter [312/312] Loss1: 0.1340 Loss2: 0.1525 Total Loss: 0.2865
2022-12-18 22:13:56,154 - INFO - Epoch [89/120], alpha for ImgNet: 9.4340, alpha for TxtNet: 9.4340
2022-12-18 22:14:29,226 - INFO - Epoch [89/120], Iter [156/312] Loss1: 0.0838 Loss2: 0.1947 Total Loss: 0.2785
2022-12-18 22:15:00,866 - INFO - Epoch [89/120], Iter [312/312] Loss1: 0.1350 Loss2: 0.1772 Total Loss: 0.3122
2022-12-18 22:15:01,120 - INFO - Epoch [90/120], alpha for ImgNet: 9.4868, alpha for TxtNet: 9.4868
2022-12-18 22:15:34,417 - INFO - Epoch [90/120], Iter [156/312] Loss1: 0.0805 Loss2: 0.1886 Total Loss: 0.2691
2022-12-18 22:16:06,124 - INFO - Epoch [90/120], Iter [312/312] Loss1: 0.0855 Loss2: 0.1718 Total Loss: 0.2574
2022-12-18 22:16:06,395 - INFO - Epoch [91/120], alpha for ImgNet: 9.5394, alpha for TxtNet: 9.5394
2022-12-18 22:16:39,573 - INFO - Epoch [91/120], Iter [156/312] Loss1: 0.1084 Loss2: 0.2097 Total Loss: 0.3180
2022-12-18 22:17:11,222 - INFO - Epoch [91/120], Iter [312/312] Loss1: 0.1208 Loss2: 0.1872 Total Loss: 0.3079
2022-12-18 22:17:11,483 - INFO - Epoch [92/120], alpha for ImgNet: 9.5917, alpha for TxtNet: 9.5917
2022-12-18 22:17:44,826 - INFO - Epoch [92/120], Iter [156/312] Loss1: 0.1122 Loss2: 0.1704 Total Loss: 0.2825
2022-12-18 22:18:16,535 - INFO - Epoch [92/120], Iter [312/312] Loss1: 0.0996 Loss2: 0.1758 Total Loss: 0.2754
2022-12-18 22:18:16,784 - INFO - Epoch [93/120], alpha for ImgNet: 9.6437, alpha for TxtNet: 9.6437
2022-12-18 22:18:49,864 - INFO - Epoch [93/120], Iter [156/312] Loss1: 0.1114 Loss2: 0.2038 Total Loss: 0.3152
2022-12-18 22:19:21,607 - INFO - Epoch [93/120], Iter [312/312] Loss1: 0.1120 Loss2: 0.1795 Total Loss: 0.2914
2022-12-18 22:19:21,828 - INFO - Epoch [94/120], alpha for ImgNet: 9.6954, alpha for TxtNet: 9.6954
2022-12-18 22:19:54,989 - INFO - Epoch [94/120], Iter [156/312] Loss1: 0.0944 Loss2: 0.1600 Total Loss: 0.2543
2022-12-18 22:20:26,702 - INFO - Epoch [94/120], Iter [312/312] Loss1: 0.0829 Loss2: 0.1587 Total Loss: 0.2416
2022-12-18 22:20:26,906 - INFO - Epoch [95/120], alpha for ImgNet: 9.7468, alpha for TxtNet: 9.7468
2022-12-18 22:20:59,968 - INFO - Epoch [95/120], Iter [156/312] Loss1: 0.0962 Loss2: 0.1741 Total Loss: 0.2702
2022-12-18 22:21:31,675 - INFO - Epoch [95/120], Iter [312/312] Loss1: 0.1001 Loss2: 0.1945 Total Loss: 0.2946
2022-12-18 22:21:31,911 - INFO - Epoch [96/120], alpha for ImgNet: 9.7980, alpha for TxtNet: 9.7980
2022-12-18 22:22:05,138 - INFO - Epoch [96/120], Iter [156/312] Loss1: 0.0921 Loss2: 0.1669 Total Loss: 0.2590
2022-12-18 22:22:36,805 - INFO - Epoch [96/120], Iter [312/312] Loss1: 0.1010 Loss2: 0.1665 Total Loss: 0.2675
2022-12-18 22:22:37,034 - INFO - Epoch [97/120], alpha for ImgNet: 9.8489, alpha for TxtNet: 9.8489
2022-12-18 22:23:10,174 - INFO - Epoch [97/120], Iter [156/312] Loss1: 0.0772 Loss2: 0.1883 Total Loss: 0.2655
2022-12-18 22:23:41,810 - INFO - Epoch [97/120], Iter [312/312] Loss1: 0.0842 Loss2: 0.1789 Total Loss: 0.2630
2022-12-18 22:23:42,061 - INFO - Epoch [98/120], alpha for ImgNet: 9.8995, alpha for TxtNet: 9.8995
2022-12-18 22:24:15,225 - INFO - Epoch [98/120], Iter [156/312] Loss1: 0.0834 Loss2: 0.1938 Total Loss: 0.2772
2022-12-18 22:24:46,899 - INFO - Epoch [98/120], Iter [312/312] Loss1: 0.1308 Loss2: 0.1492 Total Loss: 0.2800
2022-12-18 22:24:47,122 - INFO - Epoch [99/120], alpha for ImgNet: 9.9499, alpha for TxtNet: 9.9499
2022-12-18 22:25:20,349 - INFO - Epoch [99/120], Iter [156/312] Loss1: 0.1141 Loss2: 0.1471 Total Loss: 0.2612
2022-12-18 22:25:52,025 - INFO - Epoch [99/120], Iter [312/312] Loss1: 0.1066 Loss2: 0.1808 Total Loss: 0.2874
2022-12-18 22:25:52,256 - INFO - Epoch [100/120], alpha for ImgNet: 10.0000, alpha for TxtNet: 10.0000
2022-12-18 22:26:25,272 - INFO - Epoch [100/120], Iter [156/312] Loss1: 0.0841 Loss2: 0.1872 Total Loss: 0.2713
2022-12-18 22:26:56,773 - INFO - Epoch [100/120], Iter [312/312] Loss1: 0.0686 Loss2: 0.1650 Total Loss: 0.2336
2022-12-18 22:26:56,956 - INFO - Epoch [101/120], alpha for ImgNet: 10.0499, alpha for TxtNet: 10.0499
2022-12-18 22:27:30,077 - INFO - Epoch [101/120], Iter [156/312] Loss1: 0.1090 Loss2: 0.1984 Total Loss: 0.3073
2022-12-18 22:28:01,636 - INFO - Epoch [101/120], Iter [312/312] Loss1: 0.1131 Loss2: 0.1723 Total Loss: 0.2855
2022-12-18 22:28:01,845 - INFO - Epoch [102/120], alpha for ImgNet: 10.0995, alpha for TxtNet: 10.0995
2022-12-18 22:28:34,933 - INFO - Epoch [102/120], Iter [156/312] Loss1: 0.1108 Loss2: 0.1569 Total Loss: 0.2676
2022-12-18 22:29:06,489 - INFO - Epoch [102/120], Iter [312/312] Loss1: 0.0844 Loss2: 0.1916 Total Loss: 0.2760
2022-12-18 22:29:06,696 - INFO - Epoch [103/120], alpha for ImgNet: 10.1489, alpha for TxtNet: 10.1489
2022-12-18 22:29:39,511 - INFO - Epoch [103/120], Iter [156/312] Loss1: 0.0906 Loss2: 0.1797 Total Loss: 0.2704
2022-12-18 22:30:11,105 - INFO - Epoch [103/120], Iter [312/312] Loss1: 0.1004 Loss2: 0.1998 Total Loss: 0.3002
2022-12-18 22:30:11,322 - INFO - Epoch [104/120], alpha for ImgNet: 10.1980, alpha for TxtNet: 10.1980
2022-12-18 22:30:44,082 - INFO - Epoch [104/120], Iter [156/312] Loss1: 0.0961 Loss2: 0.1769 Total Loss: 0.2730
2022-12-18 22:31:15,634 - INFO - Epoch [104/120], Iter [312/312] Loss1: 0.1134 Loss2: 0.1852 Total Loss: 0.2986
2022-12-18 22:31:15,824 - INFO - Epoch [105/120], alpha for ImgNet: 10.2470, alpha for TxtNet: 10.2470
2022-12-18 22:31:48,839 - INFO - Epoch [105/120], Iter [156/312] Loss1: 0.1285 Loss2: 0.1543 Total Loss: 0.2829
2022-12-18 22:32:20,456 - INFO - Epoch [105/120], Iter [312/312] Loss1: 0.0639 Loss2: 0.1741 Total Loss: 0.2379
2022-12-18 22:32:20,672 - INFO - Epoch [106/120], alpha for ImgNet: 10.2956, alpha for TxtNet: 10.2956
2022-12-18 22:32:53,893 - INFO - Epoch [106/120], Iter [156/312] Loss1: 0.0881 Loss2: 0.2034 Total Loss: 0.2915
2022-12-18 22:33:25,635 - INFO - Epoch [106/120], Iter [312/312] Loss1: 0.1403 Loss2: 0.1777 Total Loss: 0.3180
2022-12-18 22:33:25,880 - INFO - Epoch [107/120], alpha for ImgNet: 10.3441, alpha for TxtNet: 10.3441
2022-12-18 22:33:59,086 - INFO - Epoch [107/120], Iter [156/312] Loss1: 0.0899 Loss2: 0.1854 Total Loss: 0.2753
2022-12-18 22:34:30,820 - INFO - Epoch [107/120], Iter [312/312] Loss1: 0.0777 Loss2: 0.1806 Total Loss: 0.2583
2022-12-18 22:34:31,093 - INFO - Epoch [108/120], alpha for ImgNet: 10.3923, alpha for TxtNet: 10.3923
2022-12-18 22:35:04,348 - INFO - Epoch [108/120], Iter [156/312] Loss1: 0.0819 Loss2: 0.1875 Total Loss: 0.2694
2022-12-18 22:35:36,064 - INFO - Epoch [108/120], Iter [312/312] Loss1: 0.0802 Loss2: 0.1909 Total Loss: 0.2711
2022-12-18 22:35:36,279 - INFO - Epoch [109/120], alpha for ImgNet: 10.4403, alpha for TxtNet: 10.4403
2022-12-18 22:36:09,613 - INFO - Epoch [109/120], Iter [156/312] Loss1: 0.0678 Loss2: 0.1879 Total Loss: 0.2556
2022-12-18 22:36:41,437 - INFO - Epoch [109/120], Iter [312/312] Loss1: 0.0846 Loss2: 0.1772 Total Loss: 0.2618
2022-12-18 22:36:41,646 - INFO - Epoch [110/120], alpha for ImgNet: 10.4881, alpha for TxtNet: 10.4881
2022-12-18 22:37:14,849 - INFO - Epoch [110/120], Iter [156/312] Loss1: 0.0824 Loss2: 0.1744 Total Loss: 0.2569
2022-12-18 22:37:46,614 - INFO - Epoch [110/120], Iter [312/312] Loss1: 0.0960 Loss2: 0.1906 Total Loss: 0.2866
2022-12-18 22:37:46,866 - INFO - Epoch [111/120], alpha for ImgNet: 10.5357, alpha for TxtNet: 10.5357
2022-12-18 22:38:20,315 - INFO - Epoch [111/120], Iter [156/312] Loss1: 0.0608 Loss2: 0.1707 Total Loss: 0.2315
2022-12-18 22:38:52,098 - INFO - Epoch [111/120], Iter [312/312] Loss1: 0.1035 Loss2: 0.2030 Total Loss: 0.3065
2022-12-18 22:38:52,310 - INFO - Epoch [112/120], alpha for ImgNet: 10.5830, alpha for TxtNet: 10.5830
2022-12-18 22:39:25,694 - INFO - Epoch [112/120], Iter [156/312] Loss1: 0.1063 Loss2: 0.1732 Total Loss: 0.2795
2022-12-18 22:39:57,479 - INFO - Epoch [112/120], Iter [312/312] Loss1: 0.0901 Loss2: 0.1713 Total Loss: 0.2614
2022-12-18 22:39:57,697 - INFO - Epoch [113/120], alpha for ImgNet: 10.6301, alpha for TxtNet: 10.6301
2022-12-18 22:40:30,913 - INFO - Epoch [113/120], Iter [156/312] Loss1: 0.0705 Loss2: 0.1705 Total Loss: 0.2411
2022-12-18 22:41:02,683 - INFO - Epoch [113/120], Iter [312/312] Loss1: 0.1116 Loss2: 0.1484 Total Loss: 0.2601
2022-12-18 22:41:02,895 - INFO - Epoch [114/120], alpha for ImgNet: 10.6771, alpha for TxtNet: 10.6771
2022-12-18 22:41:36,274 - INFO - Epoch [114/120], Iter [156/312] Loss1: 0.0944 Loss2: 0.1550 Total Loss: 0.2494
2022-12-18 22:42:08,134 - INFO - Epoch [114/120], Iter [312/312] Loss1: 0.0914 Loss2: 0.1772 Total Loss: 0.2686
2022-12-18 22:42:08,363 - INFO - Epoch [115/120], alpha for ImgNet: 10.7238, alpha for TxtNet: 10.7238
2022-12-18 22:42:41,577 - INFO - Epoch [115/120], Iter [156/312] Loss1: 0.1140 Loss2: 0.1664 Total Loss: 0.2803
2022-12-18 22:43:13,269 - INFO - Epoch [115/120], Iter [312/312] Loss1: 0.0846 Loss2: 0.1898 Total Loss: 0.2744
2022-12-18 22:43:13,504 - INFO - Epoch [116/120], alpha for ImgNet: 10.7703, alpha for TxtNet: 10.7703
2022-12-18 22:43:46,761 - INFO - Epoch [116/120], Iter [156/312] Loss1: 0.1119 Loss2: 0.1915 Total Loss: 0.3034
2022-12-18 22:44:18,521 - INFO - Epoch [116/120], Iter [312/312] Loss1: 0.1609 Loss2: 0.1956 Total Loss: 0.3565
2022-12-18 22:44:18,777 - INFO - Epoch [117/120], alpha for ImgNet: 10.8167, alpha for TxtNet: 10.8167
2022-12-18 22:44:52,052 - INFO - Epoch [117/120], Iter [156/312] Loss1: 0.1160 Loss2: 0.1617 Total Loss: 0.2777
2022-12-18 22:45:23,768 - INFO - Epoch [117/120], Iter [312/312] Loss1: 0.0828 Loss2: 0.1407 Total Loss: 0.2236
2022-12-18 22:45:24,020 - INFO - Epoch [118/120], alpha for ImgNet: 10.8628, alpha for TxtNet: 10.8628
2022-12-18 22:45:57,238 - INFO - Epoch [118/120], Iter [156/312] Loss1: 0.0741 Loss2: 0.1951 Total Loss: 0.2692
2022-12-18 22:46:29,116 - INFO - Epoch [118/120], Iter [312/312] Loss1: 0.0814 Loss2: 0.1588 Total Loss: 0.2402
2022-12-18 22:46:29,374 - INFO - Epoch [119/120], alpha for ImgNet: 10.9087, alpha for TxtNet: 10.9087
2022-12-18 22:47:02,701 - INFO - Epoch [119/120], Iter [156/312] Loss1: 0.0933 Loss2: 0.1746 Total Loss: 0.2679
2022-12-18 22:47:34,487 - INFO - Epoch [119/120], Iter [312/312] Loss1: 0.0685 Loss2: 0.1775 Total Loss: 0.2460
2022-12-18 22:47:34,735 - INFO - Epoch [120/120], alpha for ImgNet: 10.9545, alpha for TxtNet: 10.9545
2022-12-18 22:48:08,014 - INFO - Epoch [120/120], Iter [156/312] Loss1: 0.1209 Loss2: 0.1955 Total Loss: 0.3164
2022-12-18 22:48:39,738 - INFO - Epoch [120/120], Iter [312/312] Loss1: 0.0993 Loss2: 0.1971 Total Loss: 0.2964
2022-12-18 22:56:49,504 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-18 22:56:49,505 - INFO - MAP of Image to Text: 0.834, MAP of Text to Image: 0.790
2022-12-18 22:56:49,506 - INFO - --------------------------------------------------------------------
2022-12-18 22:57:52,503 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-18 22:57:52,504 - INFO - MAP of Image to Text: 0.679, MAP of Text to Image: 0.713
2022-12-18 22:57:52,504 - INFO - --------------------------------------------------------------------
2022-12-18 22:57:52,845 - INFO - ---------------------------Test------------------------
2022-12-18 22:57:53,651 - INFO - **************** Load checkpoint ./checkpoint/ASCH_NUSWIDE_16_bit_best_epoch.pth ****************
2022-12-18 22:57:53,654 - INFO - ********** The loaded model has been trained for 80 epochs.*********
2022-12-18 23:06:11,950 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-18 23:06:11,951 - INFO - MAP of Image to Text: 0.6830, MAP of Text to Image: 0.7178
2022-12-18 23:06:11,951 - INFO - --------------------------------------------------------------------
2022-12-18 23:15:58,430 - INFO - tensor([0.8810, 0.8237, 0.8213, 0.8186, 0.8154, 0.8140, 0.8121, 0.8100, 0.8079,
        0.8054, 0.8026, 0.8002])
2022-12-18 23:15:58,439 - INFO - tensor([0.7500, 0.7868, 0.7896, 0.7902, 0.7901, 0.7901, 0.7906, 0.7901, 0.7893,
        0.7890, 0.7887, 0.7879])
2022-12-18 23:37:24,322 - INFO - tensor([0.8219, 0.8241, 0.8213, 0.8186, 0.8140, 0.8002, 0.8002, 0.7606, 0.7337,
        0.6988, 0.6617, 0.6332, 0.6117, 0.5924, 0.5722, 0.5511, 0.5287, 0.5060,
        0.4831, 0.4611, 0.4405, 0.4208, 0.4030, 0.3867, 0.3724])
2022-12-18 23:37:24,325 - INFO - tensor([8.1493e-04, 1.6380e-03, 8.1384e-03, 1.6229e-02, 3.2191e-02, 7.7387e-02,
        7.7387e-02, 2.0392e-01, 3.1533e-01, 4.0743e-01, 4.8343e-01, 5.5233e-01,
        6.1781e-01, 6.7841e-01, 7.3324e-01, 7.8148e-01, 8.2295e-01, 8.5868e-01,
        8.8798e-01, 9.1295e-01, 9.3497e-01, 9.5359e-01, 9.7058e-01, 9.8628e-01,
        1.0000e+00])
2022-12-18 23:37:24,327 - INFO - tensor([0.7824, 0.7851, 0.7896, 0.7902, 0.7901, 0.7879, 0.7879, 0.7637, 0.7478,
        0.7267, 0.6982, 0.6723, 0.6491, 0.6267, 0.6022, 0.5746, 0.5439, 0.5143,
        0.4876, 0.4636, 0.4418, 0.4220, 0.4037, 0.3868, 0.3724])
2022-12-18 23:37:24,328 - INFO - tensor([7.2146e-04, 1.4551e-03, 7.3316e-03, 1.4725e-02, 2.9436e-02, 7.3203e-02,
        7.3203e-02, 2.0025e-01, 3.1443e-01, 4.1482e-01, 4.9684e-01, 5.7040e-01,
        6.3842e-01, 7.0130e-01, 7.5699e-01, 8.0317e-01, 8.3829e-01, 8.6681e-01,
        8.9208e-01, 9.1463e-01, 9.3518e-01, 9.5408e-01, 9.7056e-01, 9.8561e-01,
        1.0000e+00])
2022-12-18 23:38:22,978 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-18 23:38:22,981 - INFO - MAP of Image to Text: 0.8539, MAP of Text to Image: 0.7977
2022-12-18 23:38:22,981 - INFO - --------------------------------------------------------------------
