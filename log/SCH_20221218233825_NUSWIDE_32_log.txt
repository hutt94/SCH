2022-12-18 23:38:25,940 - INFO - --------------------------Current Settings--------------------------
2022-12-18 23:38:25,941 - INFO - EVAL = False
2022-12-18 23:38:25,941 - INFO - DATASET = NUSWIDE
2022-12-18 23:38:25,941 - INFO - CODE_LEN = 32
2022-12-18 23:38:25,941 - INFO - GPU_ID =  2
2022-12-18 23:38:25,941 - INFO - ALPHA = 1.0000
2022-12-18 23:38:25,941 - INFO - BETA = 1.0000
2022-12-18 23:38:25,941 - INFO - NUM_EPOCH = 120
2022-12-18 23:38:25,941 - INFO - BATCH_SIZE = 32
2022-12-18 23:38:25,941 - INFO - NUM_WORKERS = 8
2022-12-18 23:38:25,942 - INFO - EPOCH_INTERVAL = 2
2022-12-18 23:38:25,942 - INFO - EVAL_INTERVAL = 40
2022-12-18 23:38:25,942 - INFO - LR_IMG = 0.0050
2022-12-18 23:38:25,942 - INFO - LR_TXT = 0.0050
2022-12-18 23:38:25,942 - INFO - MOMENTUM = 0.7000
2022-12-18 23:38:25,942 - INFO - WEIGHT_DECAY = 0.0005
2022-12-18 23:38:25,942 - INFO - --------------------------------------------------------------------
2022-12-18 23:43:18,860 - INFO - ---------------------------Size------------------------
2022-12-18 23:43:18,860 - INFO - Training size: 10000, Test size: 2000
2022-12-18 23:43:23,020 - INFO - Epoch [1/120], alpha for ImgNet: 1.0000, alpha for TxtNet: 1.0000
2022-12-18 23:43:56,465 - INFO - Epoch [1/120], Iter [156/312] Loss1: 0.0338 Loss2: 0.8829 Total Loss: 0.9167
2022-12-18 23:44:28,307 - INFO - Epoch [1/120], Iter [312/312] Loss1: 0.0918 Loss2: 0.7526 Total Loss: 0.8443
2022-12-18 23:44:28,554 - INFO - Epoch [2/120], alpha for ImgNet: 1.4142, alpha for TxtNet: 1.4142
2022-12-18 23:45:01,830 - INFO - Epoch [2/120], Iter [156/312] Loss1: 0.0652 Loss2: 0.7747 Total Loss: 0.8399
2022-12-18 23:45:33,665 - INFO - Epoch [2/120], Iter [312/312] Loss1: 0.0795 Loss2: 0.7677 Total Loss: 0.8472
2022-12-18 23:45:33,929 - INFO - Epoch [3/120], alpha for ImgNet: 1.7321, alpha for TxtNet: 1.7321
2022-12-18 23:46:07,336 - INFO - Epoch [3/120], Iter [156/312] Loss1: 0.1023 Loss2: 0.7245 Total Loss: 0.8268
2022-12-18 23:46:39,268 - INFO - Epoch [3/120], Iter [312/312] Loss1: 0.0949 Loss2: 0.7117 Total Loss: 0.8066
2022-12-18 23:46:39,504 - INFO - Epoch [4/120], alpha for ImgNet: 2.0000, alpha for TxtNet: 2.0000
2022-12-18 23:47:12,703 - INFO - Epoch [4/120], Iter [156/312] Loss1: 0.1250 Loss2: 0.7082 Total Loss: 0.8332
2022-12-18 23:47:44,548 - INFO - Epoch [4/120], Iter [312/312] Loss1: 0.1469 Loss2: 0.7149 Total Loss: 0.8618
2022-12-18 23:47:44,824 - INFO - Epoch [5/120], alpha for ImgNet: 2.2361, alpha for TxtNet: 2.2361
2022-12-18 23:48:18,452 - INFO - Epoch [5/120], Iter [156/312] Loss1: 0.1137 Loss2: 0.6497 Total Loss: 0.7634
2022-12-18 23:48:50,399 - INFO - Epoch [5/120], Iter [312/312] Loss1: 0.1307 Loss2: 0.6649 Total Loss: 0.7956
2022-12-18 23:48:50,714 - INFO - Epoch [6/120], alpha for ImgNet: 2.4495, alpha for TxtNet: 2.4495
2022-12-18 23:49:24,224 - INFO - Epoch [6/120], Iter [156/312] Loss1: 0.1154 Loss2: 0.6471 Total Loss: 0.7625
2022-12-18 23:49:56,152 - INFO - Epoch [6/120], Iter [312/312] Loss1: 0.1283 Loss2: 0.6484 Total Loss: 0.7767
2022-12-18 23:49:56,398 - INFO - Epoch [7/120], alpha for ImgNet: 2.6458, alpha for TxtNet: 2.6458
2022-12-18 23:50:29,606 - INFO - Epoch [7/120], Iter [156/312] Loss1: 0.1366 Loss2: 0.6009 Total Loss: 0.7375
2022-12-18 23:51:01,437 - INFO - Epoch [7/120], Iter [312/312] Loss1: 0.1343 Loss2: 0.6525 Total Loss: 0.7868
2022-12-18 23:51:01,701 - INFO - Epoch [8/120], alpha for ImgNet: 2.8284, alpha for TxtNet: 2.8284
2022-12-18 23:51:35,189 - INFO - Epoch [8/120], Iter [156/312] Loss1: 0.1777 Loss2: 0.5951 Total Loss: 0.7728
2022-12-18 23:52:07,024 - INFO - Epoch [8/120], Iter [312/312] Loss1: 0.1361 Loss2: 0.6350 Total Loss: 0.7711
2022-12-18 23:52:07,263 - INFO - Epoch [9/120], alpha for ImgNet: 3.0000, alpha for TxtNet: 3.0000
2022-12-18 23:52:40,537 - INFO - Epoch [9/120], Iter [156/312] Loss1: 0.2197 Loss2: 0.6178 Total Loss: 0.8374
2022-12-18 23:53:12,294 - INFO - Epoch [9/120], Iter [312/312] Loss1: 0.2203 Loss2: 0.5786 Total Loss: 0.7989
2022-12-18 23:53:12,541 - INFO - Epoch [10/120], alpha for ImgNet: 3.1623, alpha for TxtNet: 3.1623
2022-12-18 23:53:45,730 - INFO - Epoch [10/120], Iter [156/312] Loss1: 0.2062 Loss2: 0.6257 Total Loss: 0.8319
2022-12-18 23:54:17,745 - INFO - Epoch [10/120], Iter [312/312] Loss1: 0.1783 Loss2: 0.6079 Total Loss: 0.7863
2022-12-18 23:54:17,999 - INFO - Epoch [11/120], alpha for ImgNet: 3.3166, alpha for TxtNet: 3.3166
2022-12-18 23:54:51,442 - INFO - Epoch [11/120], Iter [156/312] Loss1: 0.1251 Loss2: 0.6372 Total Loss: 0.7623
2022-12-18 23:55:23,333 - INFO - Epoch [11/120], Iter [312/312] Loss1: 0.1552 Loss2: 0.5423 Total Loss: 0.6975
2022-12-18 23:55:23,596 - INFO - Epoch [12/120], alpha for ImgNet: 3.4641, alpha for TxtNet: 3.4641
2022-12-18 23:55:56,994 - INFO - Epoch [12/120], Iter [156/312] Loss1: 0.1940 Loss2: 0.5210 Total Loss: 0.7149
2022-12-18 23:56:28,880 - INFO - Epoch [12/120], Iter [312/312] Loss1: 0.2111 Loss2: 0.5448 Total Loss: 0.7558
2022-12-18 23:56:29,132 - INFO - Epoch [13/120], alpha for ImgNet: 3.6056, alpha for TxtNet: 3.6056
2022-12-18 23:57:02,277 - INFO - Epoch [13/120], Iter [156/312] Loss1: 0.1728 Loss2: 0.5473 Total Loss: 0.7201
2022-12-18 23:57:34,020 - INFO - Epoch [13/120], Iter [312/312] Loss1: 0.1424 Loss2: 0.6370 Total Loss: 0.7794
2022-12-18 23:57:34,231 - INFO - Epoch [14/120], alpha for ImgNet: 3.7417, alpha for TxtNet: 3.7417
2022-12-18 23:58:07,317 - INFO - Epoch [14/120], Iter [156/312] Loss1: 0.1593 Loss2: 0.5581 Total Loss: 0.7174
2022-12-18 23:58:38,890 - INFO - Epoch [14/120], Iter [312/312] Loss1: 0.1663 Loss2: 0.5409 Total Loss: 0.7072
2022-12-18 23:58:39,155 - INFO - Epoch [15/120], alpha for ImgNet: 3.8730, alpha for TxtNet: 3.8730
2022-12-18 23:59:12,175 - INFO - Epoch [15/120], Iter [156/312] Loss1: 0.1670 Loss2: 0.5603 Total Loss: 0.7274
2022-12-18 23:59:43,757 - INFO - Epoch [15/120], Iter [312/312] Loss1: 0.1893 Loss2: 0.5543 Total Loss: 0.7435
2022-12-18 23:59:43,972 - INFO - Epoch [16/120], alpha for ImgNet: 4.0000, alpha for TxtNet: 4.0000
2022-12-19 00:00:16,958 - INFO - Epoch [16/120], Iter [156/312] Loss1: 0.1722 Loss2: 0.5612 Total Loss: 0.7334
2022-12-19 00:00:48,473 - INFO - Epoch [16/120], Iter [312/312] Loss1: 0.1720 Loss2: 0.5365 Total Loss: 0.7085
2022-12-19 00:00:48,672 - INFO - Epoch [17/120], alpha for ImgNet: 4.1231, alpha for TxtNet: 4.1231
2022-12-19 00:01:21,751 - INFO - Epoch [17/120], Iter [156/312] Loss1: 0.1858 Loss2: 0.5495 Total Loss: 0.7353
2022-12-19 00:01:53,403 - INFO - Epoch [17/120], Iter [312/312] Loss1: 0.2607 Loss2: 0.5241 Total Loss: 0.7848
2022-12-19 00:01:53,644 - INFO - Epoch [18/120], alpha for ImgNet: 4.2426, alpha for TxtNet: 4.2426
2022-12-19 00:02:26,624 - INFO - Epoch [18/120], Iter [156/312] Loss1: 0.2247 Loss2: 0.4933 Total Loss: 0.7180
2022-12-19 00:02:58,041 - INFO - Epoch [18/120], Iter [312/312] Loss1: 0.2574 Loss2: 0.4839 Total Loss: 0.7412
2022-12-19 00:02:58,300 - INFO - Epoch [19/120], alpha for ImgNet: 4.3589, alpha for TxtNet: 4.3589
2022-12-19 00:03:31,388 - INFO - Epoch [19/120], Iter [156/312] Loss1: 0.1833 Loss2: 0.5822 Total Loss: 0.7655
2022-12-19 00:04:03,022 - INFO - Epoch [19/120], Iter [312/312] Loss1: 0.1695 Loss2: 0.5588 Total Loss: 0.7282
2022-12-19 00:04:03,245 - INFO - Epoch [20/120], alpha for ImgNet: 4.4721, alpha for TxtNet: 4.4721
2022-12-19 00:04:36,645 - INFO - Epoch [20/120], Iter [156/312] Loss1: 0.2106 Loss2: 0.5172 Total Loss: 0.7278
2022-12-19 00:05:08,384 - INFO - Epoch [20/120], Iter [312/312] Loss1: 0.2075 Loss2: 0.5221 Total Loss: 0.7296
2022-12-19 00:05:08,647 - INFO - Epoch [21/120], alpha for ImgNet: 4.5826, alpha for TxtNet: 4.5826
2022-12-19 00:05:41,812 - INFO - Epoch [21/120], Iter [156/312] Loss1: 0.1777 Loss2: 0.5264 Total Loss: 0.7041
2022-12-19 00:06:13,508 - INFO - Epoch [21/120], Iter [312/312] Loss1: 0.1597 Loss2: 0.4806 Total Loss: 0.6403
2022-12-19 00:06:13,778 - INFO - Epoch [22/120], alpha for ImgNet: 4.6904, alpha for TxtNet: 4.6904
2022-12-19 00:06:46,966 - INFO - Epoch [22/120], Iter [156/312] Loss1: 0.2397 Loss2: 0.4920 Total Loss: 0.7317
2022-12-19 00:07:18,643 - INFO - Epoch [22/120], Iter [312/312] Loss1: 0.1991 Loss2: 0.5068 Total Loss: 0.7059
2022-12-19 00:07:18,882 - INFO - Epoch [23/120], alpha for ImgNet: 4.7958, alpha for TxtNet: 4.7958
2022-12-19 00:07:52,142 - INFO - Epoch [23/120], Iter [156/312] Loss1: 0.2029 Loss2: 0.5647 Total Loss: 0.7677
2022-12-19 00:08:23,924 - INFO - Epoch [23/120], Iter [312/312] Loss1: 0.1736 Loss2: 0.5100 Total Loss: 0.6836
2022-12-19 00:08:24,134 - INFO - Epoch [24/120], alpha for ImgNet: 4.8990, alpha for TxtNet: 4.8990
2022-12-19 00:08:57,472 - INFO - Epoch [24/120], Iter [156/312] Loss1: 0.1763 Loss2: 0.4682 Total Loss: 0.6445
2022-12-19 00:09:29,211 - INFO - Epoch [24/120], Iter [312/312] Loss1: 0.2306 Loss2: 0.5055 Total Loss: 0.7361
2022-12-19 00:09:29,488 - INFO - Epoch [25/120], alpha for ImgNet: 5.0000, alpha for TxtNet: 5.0000
2022-12-19 00:10:02,799 - INFO - Epoch [25/120], Iter [156/312] Loss1: 0.2292 Loss2: 0.4592 Total Loss: 0.6883
2022-12-19 00:10:34,450 - INFO - Epoch [25/120], Iter [312/312] Loss1: 0.1896 Loss2: 0.4945 Total Loss: 0.6841
2022-12-19 00:10:34,749 - INFO - Epoch [26/120], alpha for ImgNet: 5.0990, alpha for TxtNet: 5.0990
2022-12-19 00:11:08,081 - INFO - Epoch [26/120], Iter [156/312] Loss1: 0.1898 Loss2: 0.4960 Total Loss: 0.6858
2022-12-19 00:11:39,916 - INFO - Epoch [26/120], Iter [312/312] Loss1: 0.2262 Loss2: 0.4593 Total Loss: 0.6855
2022-12-19 00:11:40,185 - INFO - Epoch [27/120], alpha for ImgNet: 5.1962, alpha for TxtNet: 5.1962
2022-12-19 00:12:13,487 - INFO - Epoch [27/120], Iter [156/312] Loss1: 0.2095 Loss2: 0.4522 Total Loss: 0.6617
2022-12-19 00:12:45,235 - INFO - Epoch [27/120], Iter [312/312] Loss1: 0.1797 Loss2: 0.4363 Total Loss: 0.6160
2022-12-19 00:12:45,513 - INFO - Epoch [28/120], alpha for ImgNet: 5.2915, alpha for TxtNet: 5.2915
2022-12-19 00:13:18,795 - INFO - Epoch [28/120], Iter [156/312] Loss1: 0.2312 Loss2: 0.4613 Total Loss: 0.6925
2022-12-19 00:13:50,630 - INFO - Epoch [28/120], Iter [312/312] Loss1: 0.1852 Loss2: 0.4972 Total Loss: 0.6824
2022-12-19 00:13:50,887 - INFO - Epoch [29/120], alpha for ImgNet: 5.3852, alpha for TxtNet: 5.3852
2022-12-19 00:14:24,299 - INFO - Epoch [29/120], Iter [156/312] Loss1: 0.2285 Loss2: 0.4460 Total Loss: 0.6745
2022-12-19 00:14:56,227 - INFO - Epoch [29/120], Iter [312/312] Loss1: 0.1813 Loss2: 0.4671 Total Loss: 0.6485
2022-12-19 00:14:56,496 - INFO - Epoch [30/120], alpha for ImgNet: 5.4772, alpha for TxtNet: 5.4772
2022-12-19 00:15:30,064 - INFO - Epoch [30/120], Iter [156/312] Loss1: 0.1981 Loss2: 0.4741 Total Loss: 0.6722
2022-12-19 00:16:01,879 - INFO - Epoch [30/120], Iter [312/312] Loss1: 0.2163 Loss2: 0.4513 Total Loss: 0.6676
2022-12-19 00:16:02,111 - INFO - Epoch [31/120], alpha for ImgNet: 5.5678, alpha for TxtNet: 5.5678
2022-12-19 00:16:35,500 - INFO - Epoch [31/120], Iter [156/312] Loss1: 0.2183 Loss2: 0.4653 Total Loss: 0.6836
2022-12-19 00:17:07,329 - INFO - Epoch [31/120], Iter [312/312] Loss1: 0.2143 Loss2: 0.4362 Total Loss: 0.6505
2022-12-19 00:17:07,617 - INFO - Epoch [32/120], alpha for ImgNet: 5.6569, alpha for TxtNet: 5.6569
2022-12-19 00:17:40,968 - INFO - Epoch [32/120], Iter [156/312] Loss1: 0.2350 Loss2: 0.4430 Total Loss: 0.6779
2022-12-19 00:18:12,750 - INFO - Epoch [32/120], Iter [312/312] Loss1: 0.1922 Loss2: 0.4447 Total Loss: 0.6369
2022-12-19 00:18:13,071 - INFO - Epoch [33/120], alpha for ImgNet: 5.7446, alpha for TxtNet: 5.7446
2022-12-19 00:18:46,361 - INFO - Epoch [33/120], Iter [156/312] Loss1: 0.1789 Loss2: 0.4353 Total Loss: 0.6142
2022-12-19 00:19:18,135 - INFO - Epoch [33/120], Iter [312/312] Loss1: 0.1714 Loss2: 0.4811 Total Loss: 0.6525
2022-12-19 00:19:18,421 - INFO - Epoch [34/120], alpha for ImgNet: 5.8310, alpha for TxtNet: 5.8310
2022-12-19 00:19:51,837 - INFO - Epoch [34/120], Iter [156/312] Loss1: 0.2532 Loss2: 0.3972 Total Loss: 0.6505
2022-12-19 00:20:23,614 - INFO - Epoch [34/120], Iter [312/312] Loss1: 0.2048 Loss2: 0.4783 Total Loss: 0.6832
2022-12-19 00:20:23,890 - INFO - Epoch [35/120], alpha for ImgNet: 5.9161, alpha for TxtNet: 5.9161
2022-12-19 00:20:57,103 - INFO - Epoch [35/120], Iter [156/312] Loss1: 0.2375 Loss2: 0.4035 Total Loss: 0.6410
2022-12-19 00:21:28,858 - INFO - Epoch [35/120], Iter [312/312] Loss1: 0.2423 Loss2: 0.4646 Total Loss: 0.7069
2022-12-19 00:21:29,116 - INFO - Epoch [36/120], alpha for ImgNet: 6.0000, alpha for TxtNet: 6.0000
2022-12-19 00:22:02,394 - INFO - Epoch [36/120], Iter [156/312] Loss1: 0.1590 Loss2: 0.4707 Total Loss: 0.6297
2022-12-19 00:22:34,169 - INFO - Epoch [36/120], Iter [312/312] Loss1: 0.1496 Loss2: 0.3678 Total Loss: 0.5174
2022-12-19 00:22:34,443 - INFO - Epoch [37/120], alpha for ImgNet: 6.0828, alpha for TxtNet: 6.0828
2022-12-19 00:23:07,710 - INFO - Epoch [37/120], Iter [156/312] Loss1: 0.1656 Loss2: 0.4089 Total Loss: 0.5746
2022-12-19 00:23:39,485 - INFO - Epoch [37/120], Iter [312/312] Loss1: 0.2335 Loss2: 0.4308 Total Loss: 0.6643
2022-12-19 00:23:39,762 - INFO - Epoch [38/120], alpha for ImgNet: 6.1644, alpha for TxtNet: 6.1644
2022-12-19 00:24:13,019 - INFO - Epoch [38/120], Iter [156/312] Loss1: 0.1631 Loss2: 0.4046 Total Loss: 0.5676
2022-12-19 00:24:44,711 - INFO - Epoch [38/120], Iter [312/312] Loss1: 0.2540 Loss2: 0.3966 Total Loss: 0.6506
2022-12-19 00:24:45,029 - INFO - Epoch [39/120], alpha for ImgNet: 6.2450, alpha for TxtNet: 6.2450
2022-12-19 00:25:18,430 - INFO - Epoch [39/120], Iter [156/312] Loss1: 0.2600 Loss2: 0.4081 Total Loss: 0.6681
2022-12-19 00:25:50,216 - INFO - Epoch [39/120], Iter [312/312] Loss1: 0.2101 Loss2: 0.4290 Total Loss: 0.6391
2022-12-19 00:25:50,464 - INFO - Epoch [40/120], alpha for ImgNet: 6.3246, alpha for TxtNet: 6.3246
2022-12-19 00:26:23,802 - INFO - Epoch [40/120], Iter [156/312] Loss1: 0.2296 Loss2: 0.3883 Total Loss: 0.6179
2022-12-19 00:26:55,519 - INFO - Epoch [40/120], Iter [312/312] Loss1: 0.2271 Loss2: 0.3986 Total Loss: 0.6257
2022-12-19 00:35:15,470 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-19 00:35:15,472 - INFO - MAP of Image to Text: 0.855, MAP of Text to Image: 0.793
2022-12-19 00:35:15,472 - INFO - --------------------------------------------------------------------
2022-12-19 00:36:27,645 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-19 00:36:27,646 - INFO - MAP of Image to Text: 0.684, MAP of Text to Image: 0.729
2022-12-19 00:36:27,646 - INFO - --------------------------------------------------------------------
2022-12-19 00:36:31,211 - INFO - **********Save the trained model successfully.**********
2022-12-19 00:36:31,212 - INFO - #########is best:1.4132 #########
2022-12-19 00:36:31,514 - INFO - Epoch [41/120], alpha for ImgNet: 6.4031, alpha for TxtNet: 6.4031
2022-12-19 00:37:04,626 - INFO - Epoch [41/120], Iter [156/312] Loss1: 0.1875 Loss2: 0.4335 Total Loss: 0.6209
2022-12-19 00:37:36,252 - INFO - Epoch [41/120], Iter [312/312] Loss1: 0.2064 Loss2: 0.3912 Total Loss: 0.5975
2022-12-19 00:37:36,510 - INFO - Epoch [42/120], alpha for ImgNet: 6.4807, alpha for TxtNet: 6.4807
2022-12-19 00:38:09,794 - INFO - Epoch [42/120], Iter [156/312] Loss1: 0.2163 Loss2: 0.3665 Total Loss: 0.5828
2022-12-19 00:38:41,546 - INFO - Epoch [42/120], Iter [312/312] Loss1: 0.2188 Loss2: 0.3621 Total Loss: 0.5809
2022-12-19 00:38:41,817 - INFO - Epoch [43/120], alpha for ImgNet: 6.5574, alpha for TxtNet: 6.5574
2022-12-19 00:39:14,973 - INFO - Epoch [43/120], Iter [156/312] Loss1: 0.2197 Loss2: 0.4162 Total Loss: 0.6358
2022-12-19 00:39:46,723 - INFO - Epoch [43/120], Iter [312/312] Loss1: 0.2294 Loss2: 0.3709 Total Loss: 0.6003
2022-12-19 00:39:47,011 - INFO - Epoch [44/120], alpha for ImgNet: 6.6332, alpha for TxtNet: 6.6332
2022-12-19 00:40:20,352 - INFO - Epoch [44/120], Iter [156/312] Loss1: 0.2389 Loss2: 0.3714 Total Loss: 0.6103
2022-12-19 00:40:52,271 - INFO - Epoch [44/120], Iter [312/312] Loss1: 0.1393 Loss2: 0.4333 Total Loss: 0.5726
2022-12-19 00:40:52,528 - INFO - Epoch [45/120], alpha for ImgNet: 6.7082, alpha for TxtNet: 6.7082
2022-12-19 00:41:25,684 - INFO - Epoch [45/120], Iter [156/312] Loss1: 0.2056 Loss2: 0.4546 Total Loss: 0.6603
2022-12-19 00:41:57,235 - INFO - Epoch [45/120], Iter [312/312] Loss1: 0.2245 Loss2: 0.4227 Total Loss: 0.6472
2022-12-19 00:41:57,456 - INFO - Epoch [46/120], alpha for ImgNet: 6.7823, alpha for TxtNet: 6.7823
2022-12-19 00:42:30,424 - INFO - Epoch [46/120], Iter [156/312] Loss1: 0.1798 Loss2: 0.4110 Total Loss: 0.5908
2022-12-19 00:43:02,097 - INFO - Epoch [46/120], Iter [312/312] Loss1: 0.2047 Loss2: 0.4068 Total Loss: 0.6115
2022-12-19 00:43:02,316 - INFO - Epoch [47/120], alpha for ImgNet: 6.8557, alpha for TxtNet: 6.8557
2022-12-19 00:43:35,384 - INFO - Epoch [47/120], Iter [156/312] Loss1: 0.1657 Loss2: 0.4440 Total Loss: 0.6097
2022-12-19 00:44:06,999 - INFO - Epoch [47/120], Iter [312/312] Loss1: 0.1699 Loss2: 0.3691 Total Loss: 0.5391
2022-12-19 00:44:07,223 - INFO - Epoch [48/120], alpha for ImgNet: 6.9282, alpha for TxtNet: 6.9282
2022-12-19 00:44:40,454 - INFO - Epoch [48/120], Iter [156/312] Loss1: 0.2517 Loss2: 0.3880 Total Loss: 0.6397
2022-12-19 00:45:12,147 - INFO - Epoch [48/120], Iter [312/312] Loss1: 0.1939 Loss2: 0.4175 Total Loss: 0.6113
2022-12-19 00:45:12,362 - INFO - Epoch [49/120], alpha for ImgNet: 7.0000, alpha for TxtNet: 7.0000
2022-12-19 00:45:45,548 - INFO - Epoch [49/120], Iter [156/312] Loss1: 0.2368 Loss2: 0.4287 Total Loss: 0.6655
2022-12-19 00:46:17,236 - INFO - Epoch [49/120], Iter [312/312] Loss1: 0.2336 Loss2: 0.3860 Total Loss: 0.6196
2022-12-19 00:46:17,469 - INFO - Epoch [50/120], alpha for ImgNet: 7.0711, alpha for TxtNet: 7.0711
2022-12-19 00:46:50,556 - INFO - Epoch [50/120], Iter [156/312] Loss1: 0.2222 Loss2: 0.4329 Total Loss: 0.6551
2022-12-19 00:47:22,222 - INFO - Epoch [50/120], Iter [312/312] Loss1: 0.1705 Loss2: 0.4220 Total Loss: 0.5925
2022-12-19 00:47:22,457 - INFO - Epoch [51/120], alpha for ImgNet: 7.1414, alpha for TxtNet: 7.1414
2022-12-19 00:47:55,606 - INFO - Epoch [51/120], Iter [156/312] Loss1: 0.1900 Loss2: 0.4156 Total Loss: 0.6056
2022-12-19 00:48:27,369 - INFO - Epoch [51/120], Iter [312/312] Loss1: 0.2467 Loss2: 0.3176 Total Loss: 0.5644
2022-12-19 00:48:27,639 - INFO - Epoch [52/120], alpha for ImgNet: 7.2111, alpha for TxtNet: 7.2111
2022-12-19 00:49:00,637 - INFO - Epoch [52/120], Iter [156/312] Loss1: 0.2275 Loss2: 0.3606 Total Loss: 0.5881
2022-12-19 00:49:32,144 - INFO - Epoch [52/120], Iter [312/312] Loss1: 0.2298 Loss2: 0.3926 Total Loss: 0.6224
2022-12-19 00:49:37,516 - INFO - Epoch [53/120], alpha for ImgNet: 7.2801, alpha for TxtNet: 7.2801
2022-12-19 00:50:10,616 - INFO - Epoch [53/120], Iter [156/312] Loss1: 0.1838 Loss2: 0.3713 Total Loss: 0.5552
2022-12-19 00:50:42,245 - INFO - Epoch [53/120], Iter [312/312] Loss1: 0.2178 Loss2: 0.3851 Total Loss: 0.6029
2022-12-19 00:50:42,482 - INFO - Epoch [54/120], alpha for ImgNet: 7.3485, alpha for TxtNet: 7.3485
2022-12-19 00:51:15,526 - INFO - Epoch [54/120], Iter [156/312] Loss1: 0.2534 Loss2: 0.3859 Total Loss: 0.6393
2022-12-19 00:51:47,176 - INFO - Epoch [54/120], Iter [312/312] Loss1: 0.2468 Loss2: 0.4398 Total Loss: 0.6866
2022-12-19 00:51:47,398 - INFO - Epoch [55/120], alpha for ImgNet: 7.4162, alpha for TxtNet: 7.4162
2022-12-19 00:52:20,407 - INFO - Epoch [55/120], Iter [156/312] Loss1: 0.2181 Loss2: 0.3275 Total Loss: 0.5456
2022-12-19 00:52:52,079 - INFO - Epoch [55/120], Iter [312/312] Loss1: 0.2268 Loss2: 0.3602 Total Loss: 0.5871
2022-12-19 00:52:52,335 - INFO - Epoch [56/120], alpha for ImgNet: 7.4833, alpha for TxtNet: 7.4833
2022-12-19 00:53:25,404 - INFO - Epoch [56/120], Iter [156/312] Loss1: 0.2103 Loss2: 0.3673 Total Loss: 0.5776
2022-12-19 00:53:57,010 - INFO - Epoch [56/120], Iter [312/312] Loss1: 0.1878 Loss2: 0.3998 Total Loss: 0.5876
2022-12-19 00:53:57,212 - INFO - Epoch [57/120], alpha for ImgNet: 7.5498, alpha for TxtNet: 7.5498
2022-12-19 00:54:30,285 - INFO - Epoch [57/120], Iter [156/312] Loss1: 0.1694 Loss2: 0.4007 Total Loss: 0.5702
2022-12-19 00:55:02,024 - INFO - Epoch [57/120], Iter [312/312] Loss1: 0.2486 Loss2: 0.4043 Total Loss: 0.6529
2022-12-19 00:55:02,243 - INFO - Epoch [58/120], alpha for ImgNet: 7.6158, alpha for TxtNet: 7.6158
2022-12-19 00:55:35,359 - INFO - Epoch [58/120], Iter [156/312] Loss1: 0.2220 Loss2: 0.3245 Total Loss: 0.5465
2022-12-19 00:56:06,960 - INFO - Epoch [58/120], Iter [312/312] Loss1: 0.1992 Loss2: 0.3688 Total Loss: 0.5681
2022-12-19 00:56:07,152 - INFO - Epoch [59/120], alpha for ImgNet: 7.6811, alpha for TxtNet: 7.6811
2022-12-19 00:56:40,369 - INFO - Epoch [59/120], Iter [156/312] Loss1: 0.2391 Loss2: 0.3724 Total Loss: 0.6115
2022-12-19 00:57:12,182 - INFO - Epoch [59/120], Iter [312/312] Loss1: 0.2226 Loss2: 0.3641 Total Loss: 0.5867
2022-12-19 00:57:12,415 - INFO - Epoch [60/120], alpha for ImgNet: 7.7460, alpha for TxtNet: 7.7460
2022-12-19 00:57:45,440 - INFO - Epoch [60/120], Iter [156/312] Loss1: 0.2260 Loss2: 0.3806 Total Loss: 0.6066
2022-12-19 00:58:17,088 - INFO - Epoch [60/120], Iter [312/312] Loss1: 0.2647 Loss2: 0.3787 Total Loss: 0.6433
2022-12-19 00:58:17,306 - INFO - Epoch [61/120], alpha for ImgNet: 7.8102, alpha for TxtNet: 7.8102
2022-12-19 00:58:50,349 - INFO - Epoch [61/120], Iter [156/312] Loss1: 0.1742 Loss2: 0.3914 Total Loss: 0.5656
2022-12-19 00:59:21,928 - INFO - Epoch [61/120], Iter [312/312] Loss1: 0.2006 Loss2: 0.3819 Total Loss: 0.5825
2022-12-19 00:59:22,141 - INFO - Epoch [62/120], alpha for ImgNet: 7.8740, alpha for TxtNet: 7.8740
2022-12-19 00:59:55,260 - INFO - Epoch [62/120], Iter [156/312] Loss1: 0.1993 Loss2: 0.4106 Total Loss: 0.6099
2022-12-19 01:00:26,950 - INFO - Epoch [62/120], Iter [312/312] Loss1: 0.1797 Loss2: 0.3525 Total Loss: 0.5322
2022-12-19 01:00:27,188 - INFO - Epoch [63/120], alpha for ImgNet: 7.9373, alpha for TxtNet: 7.9373
2022-12-19 01:01:00,469 - INFO - Epoch [63/120], Iter [156/312] Loss1: 0.1775 Loss2: 0.3856 Total Loss: 0.5631
2022-12-19 01:01:32,165 - INFO - Epoch [63/120], Iter [312/312] Loss1: 0.2115 Loss2: 0.3764 Total Loss: 0.5879
2022-12-19 01:01:32,363 - INFO - Epoch [64/120], alpha for ImgNet: 8.0000, alpha for TxtNet: 8.0000
2022-12-19 01:02:05,514 - INFO - Epoch [64/120], Iter [156/312] Loss1: 0.1850 Loss2: 0.3879 Total Loss: 0.5729
2022-12-19 01:02:37,150 - INFO - Epoch [64/120], Iter [312/312] Loss1: 0.2132 Loss2: 0.3307 Total Loss: 0.5439
2022-12-19 01:02:37,345 - INFO - Epoch [65/120], alpha for ImgNet: 8.0623, alpha for TxtNet: 8.0623
2022-12-19 01:03:10,442 - INFO - Epoch [65/120], Iter [156/312] Loss1: 0.1929 Loss2: 0.4062 Total Loss: 0.5991
2022-12-19 01:03:42,065 - INFO - Epoch [65/120], Iter [312/312] Loss1: 0.2076 Loss2: 0.3489 Total Loss: 0.5566
2022-12-19 01:03:42,249 - INFO - Epoch [66/120], alpha for ImgNet: 8.1240, alpha for TxtNet: 8.1240
2022-12-19 01:04:15,391 - INFO - Epoch [66/120], Iter [156/312] Loss1: 0.2886 Loss2: 0.3704 Total Loss: 0.6590
2022-12-19 01:04:47,098 - INFO - Epoch [66/120], Iter [312/312] Loss1: 0.2137 Loss2: 0.3518 Total Loss: 0.5655
2022-12-19 01:04:47,307 - INFO - Epoch [67/120], alpha for ImgNet: 8.1854, alpha for TxtNet: 8.1854
2022-12-19 01:05:20,400 - INFO - Epoch [67/120], Iter [156/312] Loss1: 0.2349 Loss2: 0.3984 Total Loss: 0.6333
2022-12-19 01:05:52,001 - INFO - Epoch [67/120], Iter [312/312] Loss1: 0.2111 Loss2: 0.3422 Total Loss: 0.5533
2022-12-19 01:05:52,204 - INFO - Epoch [68/120], alpha for ImgNet: 8.2462, alpha for TxtNet: 8.2462
2022-12-19 01:06:25,297 - INFO - Epoch [68/120], Iter [156/312] Loss1: 0.1765 Loss2: 0.3584 Total Loss: 0.5349
2022-12-19 01:06:56,981 - INFO - Epoch [68/120], Iter [312/312] Loss1: 0.2281 Loss2: 0.3523 Total Loss: 0.5805
2022-12-19 01:06:57,192 - INFO - Epoch [69/120], alpha for ImgNet: 8.3066, alpha for TxtNet: 8.3066
2022-12-19 01:07:30,280 - INFO - Epoch [69/120], Iter [156/312] Loss1: 0.1796 Loss2: 0.3727 Total Loss: 0.5523
2022-12-19 01:08:01,922 - INFO - Epoch [69/120], Iter [312/312] Loss1: 0.2176 Loss2: 0.4044 Total Loss: 0.6220
2022-12-19 01:08:02,144 - INFO - Epoch [70/120], alpha for ImgNet: 8.3666, alpha for TxtNet: 8.3666
2022-12-19 01:08:35,271 - INFO - Epoch [70/120], Iter [156/312] Loss1: 0.2259 Loss2: 0.3557 Total Loss: 0.5817
2022-12-19 01:09:06,937 - INFO - Epoch [70/120], Iter [312/312] Loss1: 0.2439 Loss2: 0.3638 Total Loss: 0.6077
2022-12-19 01:09:07,169 - INFO - Epoch [71/120], alpha for ImgNet: 8.4261, alpha for TxtNet: 8.4261
2022-12-19 01:09:40,090 - INFO - Epoch [71/120], Iter [156/312] Loss1: 0.2728 Loss2: 0.3327 Total Loss: 0.6056
2022-12-19 01:10:11,713 - INFO - Epoch [71/120], Iter [312/312] Loss1: 0.1988 Loss2: 0.3467 Total Loss: 0.5455
2022-12-19 01:10:11,902 - INFO - Epoch [72/120], alpha for ImgNet: 8.4853, alpha for TxtNet: 8.4853
2022-12-19 01:10:44,823 - INFO - Epoch [72/120], Iter [156/312] Loss1: 0.2160 Loss2: 0.3707 Total Loss: 0.5867
2022-12-19 01:11:16,409 - INFO - Epoch [72/120], Iter [312/312] Loss1: 0.2186 Loss2: 0.2846 Total Loss: 0.5031
2022-12-19 01:11:16,634 - INFO - Epoch [73/120], alpha for ImgNet: 8.5440, alpha for TxtNet: 8.5440
2022-12-19 01:11:49,756 - INFO - Epoch [73/120], Iter [156/312] Loss1: 0.1919 Loss2: 0.3845 Total Loss: 0.5763
2022-12-19 01:12:21,449 - INFO - Epoch [73/120], Iter [312/312] Loss1: 0.2049 Loss2: 0.3661 Total Loss: 0.5710
2022-12-19 01:12:21,705 - INFO - Epoch [74/120], alpha for ImgNet: 8.6023, alpha for TxtNet: 8.6023
2022-12-19 01:12:54,911 - INFO - Epoch [74/120], Iter [156/312] Loss1: 0.2320 Loss2: 0.3390 Total Loss: 0.5710
2022-12-19 01:13:26,625 - INFO - Epoch [74/120], Iter [312/312] Loss1: 0.1608 Loss2: 0.3860 Total Loss: 0.5467
2022-12-19 01:13:26,866 - INFO - Epoch [75/120], alpha for ImgNet: 8.6603, alpha for TxtNet: 8.6603
2022-12-19 01:13:59,916 - INFO - Epoch [75/120], Iter [156/312] Loss1: 0.1652 Loss2: 0.3318 Total Loss: 0.4970
2022-12-19 01:14:31,536 - INFO - Epoch [75/120], Iter [312/312] Loss1: 0.1825 Loss2: 0.3347 Total Loss: 0.5172
2022-12-19 01:14:31,736 - INFO - Epoch [76/120], alpha for ImgNet: 8.7178, alpha for TxtNet: 8.7178
2022-12-19 01:15:04,930 - INFO - Epoch [76/120], Iter [156/312] Loss1: 0.1991 Loss2: 0.3557 Total Loss: 0.5547
2022-12-19 01:15:36,628 - INFO - Epoch [76/120], Iter [312/312] Loss1: 0.2424 Loss2: 0.3574 Total Loss: 0.5999
2022-12-19 01:15:36,883 - INFO - Epoch [77/120], alpha for ImgNet: 8.7750, alpha for TxtNet: 8.7750
2022-12-19 01:16:09,950 - INFO - Epoch [77/120], Iter [156/312] Loss1: 0.1858 Loss2: 0.3365 Total Loss: 0.5224
2022-12-19 01:16:41,687 - INFO - Epoch [77/120], Iter [312/312] Loss1: 0.1668 Loss2: 0.3448 Total Loss: 0.5116
2022-12-19 01:16:41,907 - INFO - Epoch [78/120], alpha for ImgNet: 8.8318, alpha for TxtNet: 8.8318
2022-12-19 01:17:14,940 - INFO - Epoch [78/120], Iter [156/312] Loss1: 0.2164 Loss2: 0.3168 Total Loss: 0.5332
2022-12-19 01:17:46,620 - INFO - Epoch [78/120], Iter [312/312] Loss1: 0.2432 Loss2: 0.3657 Total Loss: 0.6089
2022-12-19 01:17:46,846 - INFO - Epoch [79/120], alpha for ImgNet: 8.8882, alpha for TxtNet: 8.8882
2022-12-19 01:18:19,772 - INFO - Epoch [79/120], Iter [156/312] Loss1: 0.1582 Loss2: 0.3124 Total Loss: 0.4707
2022-12-19 01:18:51,382 - INFO - Epoch [79/120], Iter [312/312] Loss1: 0.2163 Loss2: 0.3707 Total Loss: 0.5870
2022-12-19 01:18:51,665 - INFO - Epoch [80/120], alpha for ImgNet: 8.9443, alpha for TxtNet: 8.9443
2022-12-19 01:19:24,728 - INFO - Epoch [80/120], Iter [156/312] Loss1: 0.2174 Loss2: 0.3846 Total Loss: 0.6020
2022-12-19 01:19:56,342 - INFO - Epoch [80/120], Iter [312/312] Loss1: 0.1968 Loss2: 0.3751 Total Loss: 0.5720
2022-12-19 01:28:02,534 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-19 01:28:02,535 - INFO - MAP of Image to Text: 0.855, MAP of Text to Image: 0.808
2022-12-19 01:28:02,535 - INFO - --------------------------------------------------------------------
2022-12-19 01:29:07,830 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-19 01:29:07,831 - INFO - MAP of Image to Text: 0.701, MAP of Text to Image: 0.733
2022-12-19 01:29:07,831 - INFO - --------------------------------------------------------------------
2022-12-19 01:29:11,006 - INFO - **********Save the trained model successfully.**********
2022-12-19 01:29:11,006 - INFO - #########is best:1.4339 #########
2022-12-19 01:29:11,379 - INFO - Epoch [81/120], alpha for ImgNet: 9.0000, alpha for TxtNet: 9.0000
2022-12-19 01:29:44,455 - INFO - Epoch [81/120], Iter [156/312] Loss1: 0.1742 Loss2: 0.3511 Total Loss: 0.5253
2022-12-19 01:30:16,043 - INFO - Epoch [81/120], Iter [312/312] Loss1: 0.1635 Loss2: 0.2999 Total Loss: 0.4635
2022-12-19 01:30:16,269 - INFO - Epoch [82/120], alpha for ImgNet: 9.0554, alpha for TxtNet: 9.0554
2022-12-19 01:30:49,441 - INFO - Epoch [82/120], Iter [156/312] Loss1: 0.1996 Loss2: 0.3869 Total Loss: 0.5866
2022-12-19 01:31:21,297 - INFO - Epoch [82/120], Iter [312/312] Loss1: 0.2290 Loss2: 0.3402 Total Loss: 0.5692
2022-12-19 01:31:21,527 - INFO - Epoch [83/120], alpha for ImgNet: 9.1104, alpha for TxtNet: 9.1104
2022-12-19 01:31:54,785 - INFO - Epoch [83/120], Iter [156/312] Loss1: 0.1917 Loss2: 0.3368 Total Loss: 0.5285
2022-12-19 01:32:26,451 - INFO - Epoch [83/120], Iter [312/312] Loss1: 0.1763 Loss2: 0.3402 Total Loss: 0.5164
2022-12-19 01:32:26,679 - INFO - Epoch [84/120], alpha for ImgNet: 9.1652, alpha for TxtNet: 9.1652
2022-12-19 01:32:59,797 - INFO - Epoch [84/120], Iter [156/312] Loss1: 0.1618 Loss2: 0.3541 Total Loss: 0.5159
2022-12-19 01:33:31,491 - INFO - Epoch [84/120], Iter [312/312] Loss1: 0.2103 Loss2: 0.2987 Total Loss: 0.5090
2022-12-19 01:33:31,731 - INFO - Epoch [85/120], alpha for ImgNet: 9.2195, alpha for TxtNet: 9.2195
2022-12-19 01:34:04,848 - INFO - Epoch [85/120], Iter [156/312] Loss1: 0.2091 Loss2: 0.3649 Total Loss: 0.5740
2022-12-19 01:34:36,479 - INFO - Epoch [85/120], Iter [312/312] Loss1: 0.1491 Loss2: 0.3577 Total Loss: 0.5068
2022-12-19 01:34:36,703 - INFO - Epoch [86/120], alpha for ImgNet: 9.2736, alpha for TxtNet: 9.2736
2022-12-19 01:35:09,817 - INFO - Epoch [86/120], Iter [156/312] Loss1: 0.1990 Loss2: 0.3666 Total Loss: 0.5657
2022-12-19 01:35:41,549 - INFO - Epoch [86/120], Iter [312/312] Loss1: 0.1861 Loss2: 0.3505 Total Loss: 0.5366
2022-12-19 01:35:41,743 - INFO - Epoch [87/120], alpha for ImgNet: 9.3274, alpha for TxtNet: 9.3274
2022-12-19 01:36:14,771 - INFO - Epoch [87/120], Iter [156/312] Loss1: 0.2006 Loss2: 0.3062 Total Loss: 0.5067
2022-12-19 01:36:46,356 - INFO - Epoch [87/120], Iter [312/312] Loss1: 0.1838 Loss2: 0.3231 Total Loss: 0.5069
2022-12-19 01:36:46,571 - INFO - Epoch [88/120], alpha for ImgNet: 9.3808, alpha for TxtNet: 9.3808
2022-12-19 01:37:19,717 - INFO - Epoch [88/120], Iter [156/312] Loss1: 0.1975 Loss2: 0.3392 Total Loss: 0.5367
2022-12-19 01:37:51,501 - INFO - Epoch [88/120], Iter [312/312] Loss1: 0.2005 Loss2: 0.3488 Total Loss: 0.5493
2022-12-19 01:37:51,728 - INFO - Epoch [89/120], alpha for ImgNet: 9.4340, alpha for TxtNet: 9.4340
2022-12-19 01:38:24,872 - INFO - Epoch [89/120], Iter [156/312] Loss1: 0.1952 Loss2: 0.3446 Total Loss: 0.5398
2022-12-19 01:38:56,545 - INFO - Epoch [89/120], Iter [312/312] Loss1: 0.2134 Loss2: 0.3446 Total Loss: 0.5580
2022-12-19 01:38:56,757 - INFO - Epoch [90/120], alpha for ImgNet: 9.4868, alpha for TxtNet: 9.4868
2022-12-19 01:39:29,960 - INFO - Epoch [90/120], Iter [156/312] Loss1: 0.1853 Loss2: 0.3199 Total Loss: 0.5052
2022-12-19 01:40:01,547 - INFO - Epoch [90/120], Iter [312/312] Loss1: 0.1598 Loss2: 0.3324 Total Loss: 0.4922
2022-12-19 01:40:01,785 - INFO - Epoch [91/120], alpha for ImgNet: 9.5394, alpha for TxtNet: 9.5394
2022-12-19 01:40:34,961 - INFO - Epoch [91/120], Iter [156/312] Loss1: 0.1710 Loss2: 0.3610 Total Loss: 0.5320
2022-12-19 01:41:06,644 - INFO - Epoch [91/120], Iter [312/312] Loss1: 0.1710 Loss2: 0.3225 Total Loss: 0.4934
2022-12-19 01:41:06,893 - INFO - Epoch [92/120], alpha for ImgNet: 9.5917, alpha for TxtNet: 9.5917
2022-12-19 01:41:39,909 - INFO - Epoch [92/120], Iter [156/312] Loss1: 0.1748 Loss2: 0.3275 Total Loss: 0.5023
2022-12-19 01:42:11,411 - INFO - Epoch [92/120], Iter [312/312] Loss1: 0.1891 Loss2: 0.3061 Total Loss: 0.4952
2022-12-19 01:42:11,648 - INFO - Epoch [93/120], alpha for ImgNet: 9.6437, alpha for TxtNet: 9.6437
2022-12-19 01:42:44,703 - INFO - Epoch [93/120], Iter [156/312] Loss1: 0.2165 Loss2: 0.3776 Total Loss: 0.5941
2022-12-19 01:43:16,340 - INFO - Epoch [93/120], Iter [312/312] Loss1: 0.1857 Loss2: 0.4164 Total Loss: 0.6021
2022-12-19 01:43:16,595 - INFO - Epoch [94/120], alpha for ImgNet: 9.6954, alpha for TxtNet: 9.6954
2022-12-19 01:43:49,687 - INFO - Epoch [94/120], Iter [156/312] Loss1: 0.1773 Loss2: 0.3034 Total Loss: 0.4807
2022-12-19 01:44:21,330 - INFO - Epoch [94/120], Iter [312/312] Loss1: 0.2189 Loss2: 0.3852 Total Loss: 0.6041
2022-12-19 01:44:21,543 - INFO - Epoch [95/120], alpha for ImgNet: 9.7468, alpha for TxtNet: 9.7468
2022-12-19 01:44:54,690 - INFO - Epoch [95/120], Iter [156/312] Loss1: 0.1879 Loss2: 0.3516 Total Loss: 0.5395
2022-12-19 01:45:26,448 - INFO - Epoch [95/120], Iter [312/312] Loss1: 0.1579 Loss2: 0.3340 Total Loss: 0.4918
2022-12-19 01:45:26,643 - INFO - Epoch [96/120], alpha for ImgNet: 9.7980, alpha for TxtNet: 9.7980
2022-12-19 01:45:59,809 - INFO - Epoch [96/120], Iter [156/312] Loss1: 0.2355 Loss2: 0.3329 Total Loss: 0.5684
2022-12-19 01:46:31,502 - INFO - Epoch [96/120], Iter [312/312] Loss1: 0.1462 Loss2: 0.2964 Total Loss: 0.4426
2022-12-19 01:46:31,717 - INFO - Epoch [97/120], alpha for ImgNet: 9.8489, alpha for TxtNet: 9.8489
2022-12-19 01:47:04,707 - INFO - Epoch [97/120], Iter [156/312] Loss1: 0.1813 Loss2: 0.3963 Total Loss: 0.5776
2022-12-19 01:47:36,218 - INFO - Epoch [97/120], Iter [312/312] Loss1: 0.1561 Loss2: 0.3577 Total Loss: 0.5138
2022-12-19 01:47:36,424 - INFO - Epoch [98/120], alpha for ImgNet: 9.8995, alpha for TxtNet: 9.8995
2022-12-19 01:48:09,627 - INFO - Epoch [98/120], Iter [156/312] Loss1: 0.1928 Loss2: 0.3316 Total Loss: 0.5243
2022-12-19 01:48:41,283 - INFO - Epoch [98/120], Iter [312/312] Loss1: 0.1970 Loss2: 0.2749 Total Loss: 0.4719
2022-12-19 01:48:41,508 - INFO - Epoch [99/120], alpha for ImgNet: 9.9499, alpha for TxtNet: 9.9499
2022-12-19 01:49:14,700 - INFO - Epoch [99/120], Iter [156/312] Loss1: 0.1977 Loss2: 0.3195 Total Loss: 0.5171
2022-12-19 01:49:46,489 - INFO - Epoch [99/120], Iter [312/312] Loss1: 0.1399 Loss2: 0.3355 Total Loss: 0.4754
2022-12-19 01:49:46,719 - INFO - Epoch [100/120], alpha for ImgNet: 10.0000, alpha for TxtNet: 10.0000
2022-12-19 01:50:19,695 - INFO - Epoch [100/120], Iter [156/312] Loss1: 0.1656 Loss2: 0.3799 Total Loss: 0.5456
2022-12-19 01:50:51,174 - INFO - Epoch [100/120], Iter [312/312] Loss1: 0.1799 Loss2: 0.3147 Total Loss: 0.4947
2022-12-19 01:50:51,388 - INFO - Epoch [101/120], alpha for ImgNet: 10.0499, alpha for TxtNet: 10.0499
2022-12-19 01:51:24,349 - INFO - Epoch [101/120], Iter [156/312] Loss1: 0.2406 Loss2: 0.3242 Total Loss: 0.5647
2022-12-19 01:51:55,991 - INFO - Epoch [101/120], Iter [312/312] Loss1: 0.1734 Loss2: 0.3774 Total Loss: 0.5509
2022-12-19 01:51:56,250 - INFO - Epoch [102/120], alpha for ImgNet: 10.0995, alpha for TxtNet: 10.0995
2022-12-19 01:52:29,455 - INFO - Epoch [102/120], Iter [156/312] Loss1: 0.1998 Loss2: 0.3850 Total Loss: 0.5849
2022-12-19 01:53:01,219 - INFO - Epoch [102/120], Iter [312/312] Loss1: 0.1540 Loss2: 0.2874 Total Loss: 0.4415
2022-12-19 01:53:01,447 - INFO - Epoch [103/120], alpha for ImgNet: 10.1489, alpha for TxtNet: 10.1489
2022-12-19 01:53:34,511 - INFO - Epoch [103/120], Iter [156/312] Loss1: 0.1949 Loss2: 0.3680 Total Loss: 0.5629
2022-12-19 01:54:06,093 - INFO - Epoch [103/120], Iter [312/312] Loss1: 0.2093 Loss2: 0.3102 Total Loss: 0.5196
2022-12-19 01:54:06,307 - INFO - Epoch [104/120], alpha for ImgNet: 10.1980, alpha for TxtNet: 10.1980
2022-12-19 01:54:39,354 - INFO - Epoch [104/120], Iter [156/312] Loss1: 0.1483 Loss2: 0.3621 Total Loss: 0.5104
2022-12-19 01:55:11,037 - INFO - Epoch [104/120], Iter [312/312] Loss1: 0.1449 Loss2: 0.3478 Total Loss: 0.4927
2022-12-19 01:55:11,282 - INFO - Epoch [105/120], alpha for ImgNet: 10.2470, alpha for TxtNet: 10.2470
2022-12-19 01:55:44,362 - INFO - Epoch [105/120], Iter [156/312] Loss1: 0.1580 Loss2: 0.3146 Total Loss: 0.4726
2022-12-19 01:56:16,107 - INFO - Epoch [105/120], Iter [312/312] Loss1: 0.1705 Loss2: 0.3332 Total Loss: 0.5037
2022-12-19 01:56:16,326 - INFO - Epoch [106/120], alpha for ImgNet: 10.2956, alpha for TxtNet: 10.2956
2022-12-19 01:56:49,430 - INFO - Epoch [106/120], Iter [156/312] Loss1: 0.1440 Loss2: 0.2910 Total Loss: 0.4350
2022-12-19 01:57:21,052 - INFO - Epoch [106/120], Iter [312/312] Loss1: 0.1147 Loss2: 0.3507 Total Loss: 0.4655
2022-12-19 01:57:21,310 - INFO - Epoch [107/120], alpha for ImgNet: 10.3441, alpha for TxtNet: 10.3441
2022-12-19 01:57:54,477 - INFO - Epoch [107/120], Iter [156/312] Loss1: 0.2010 Loss2: 0.3385 Total Loss: 0.5395
2022-12-19 01:58:26,048 - INFO - Epoch [107/120], Iter [312/312] Loss1: 0.1780 Loss2: 0.3695 Total Loss: 0.5475
2022-12-19 01:58:26,304 - INFO - Epoch [108/120], alpha for ImgNet: 10.3923, alpha for TxtNet: 10.3923
2022-12-19 01:58:59,303 - INFO - Epoch [108/120], Iter [156/312] Loss1: 0.2200 Loss2: 0.2581 Total Loss: 0.4781
2022-12-19 01:59:30,898 - INFO - Epoch [108/120], Iter [312/312] Loss1: 0.1330 Loss2: 0.2949 Total Loss: 0.4279
2022-12-19 01:59:31,096 - INFO - Epoch [109/120], alpha for ImgNet: 10.4403, alpha for TxtNet: 10.4403
2022-12-19 02:00:04,240 - INFO - Epoch [109/120], Iter [156/312] Loss1: 0.1680 Loss2: 0.3439 Total Loss: 0.5120
2022-12-19 02:00:35,882 - INFO - Epoch [109/120], Iter [312/312] Loss1: 0.1438 Loss2: 0.3392 Total Loss: 0.4831
2022-12-19 02:00:36,110 - INFO - Epoch [110/120], alpha for ImgNet: 10.4881, alpha for TxtNet: 10.4881
2022-12-19 02:01:09,327 - INFO - Epoch [110/120], Iter [156/312] Loss1: 0.1986 Loss2: 0.3045 Total Loss: 0.5031
2022-12-19 02:01:41,083 - INFO - Epoch [110/120], Iter [312/312] Loss1: 0.1819 Loss2: 0.3220 Total Loss: 0.5038
2022-12-19 02:01:41,280 - INFO - Epoch [111/120], alpha for ImgNet: 10.5357, alpha for TxtNet: 10.5357
2022-12-19 02:02:14,469 - INFO - Epoch [111/120], Iter [156/312] Loss1: 0.1553 Loss2: 0.3186 Total Loss: 0.4740
2022-12-19 02:02:46,141 - INFO - Epoch [111/120], Iter [312/312] Loss1: 0.1614 Loss2: 0.3524 Total Loss: 0.5138
2022-12-19 02:02:46,400 - INFO - Epoch [112/120], alpha for ImgNet: 10.5830, alpha for TxtNet: 10.5830
2022-12-19 02:03:19,564 - INFO - Epoch [112/120], Iter [156/312] Loss1: 0.1772 Loss2: 0.2740 Total Loss: 0.4511
2022-12-19 02:03:51,218 - INFO - Epoch [112/120], Iter [312/312] Loss1: 0.1878 Loss2: 0.3299 Total Loss: 0.5177
2022-12-19 02:03:51,470 - INFO - Epoch [113/120], alpha for ImgNet: 10.6301, alpha for TxtNet: 10.6301
2022-12-19 02:04:24,582 - INFO - Epoch [113/120], Iter [156/312] Loss1: 0.2099 Loss2: 0.2920 Total Loss: 0.5019
2022-12-19 02:04:56,346 - INFO - Epoch [113/120], Iter [312/312] Loss1: 0.2073 Loss2: 0.3274 Total Loss: 0.5347
2022-12-19 02:04:56,589 - INFO - Epoch [114/120], alpha for ImgNet: 10.6771, alpha for TxtNet: 10.6771
2022-12-19 02:05:29,718 - INFO - Epoch [114/120], Iter [156/312] Loss1: 0.1491 Loss2: 0.3282 Total Loss: 0.4773
2022-12-19 02:06:01,332 - INFO - Epoch [114/120], Iter [312/312] Loss1: 0.1737 Loss2: 0.3197 Total Loss: 0.4934
2022-12-19 02:06:01,568 - INFO - Epoch [115/120], alpha for ImgNet: 10.7238, alpha for TxtNet: 10.7238
2022-12-19 02:06:34,578 - INFO - Epoch [115/120], Iter [156/312] Loss1: 0.1395 Loss2: 0.2986 Total Loss: 0.4381
2022-12-19 02:07:06,240 - INFO - Epoch [115/120], Iter [312/312] Loss1: 0.2494 Loss2: 0.3377 Total Loss: 0.5871
2022-12-19 02:07:06,475 - INFO - Epoch [116/120], alpha for ImgNet: 10.7703, alpha for TxtNet: 10.7703
2022-12-19 02:07:39,547 - INFO - Epoch [116/120], Iter [156/312] Loss1: 0.1458 Loss2: 0.3076 Total Loss: 0.4534
2022-12-19 02:08:11,160 - INFO - Epoch [116/120], Iter [312/312] Loss1: 0.1077 Loss2: 0.3492 Total Loss: 0.4569
2022-12-19 02:08:11,371 - INFO - Epoch [117/120], alpha for ImgNet: 10.8167, alpha for TxtNet: 10.8167
2022-12-19 02:08:44,430 - INFO - Epoch [117/120], Iter [156/312] Loss1: 0.1589 Loss2: 0.3206 Total Loss: 0.4795
2022-12-19 02:09:16,123 - INFO - Epoch [117/120], Iter [312/312] Loss1: 0.1641 Loss2: 0.3359 Total Loss: 0.5000
2022-12-19 02:09:16,357 - INFO - Epoch [118/120], alpha for ImgNet: 10.8628, alpha for TxtNet: 10.8628
2022-12-19 02:09:49,476 - INFO - Epoch [118/120], Iter [156/312] Loss1: 0.1603 Loss2: 0.3089 Total Loss: 0.4692
2022-12-19 02:10:21,089 - INFO - Epoch [118/120], Iter [312/312] Loss1: 0.2001 Loss2: 0.3359 Total Loss: 0.5360
2022-12-19 02:10:21,319 - INFO - Epoch [119/120], alpha for ImgNet: 10.9087, alpha for TxtNet: 10.9087
2022-12-19 02:10:54,388 - INFO - Epoch [119/120], Iter [156/312] Loss1: 0.1244 Loss2: 0.2573 Total Loss: 0.3817
2022-12-19 02:11:26,120 - INFO - Epoch [119/120], Iter [312/312] Loss1: 0.1790 Loss2: 0.2996 Total Loss: 0.4786
2022-12-19 02:11:26,385 - INFO - Epoch [120/120], alpha for ImgNet: 10.9545, alpha for TxtNet: 10.9545
2022-12-19 02:11:59,521 - INFO - Epoch [120/120], Iter [156/312] Loss1: 0.1878 Loss2: 0.3420 Total Loss: 0.5298
2022-12-19 02:12:31,125 - INFO - Epoch [120/120], Iter [312/312] Loss1: 0.1719 Loss2: 0.3334 Total Loss: 0.5053
2022-12-19 02:20:40,528 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-19 02:20:40,529 - INFO - MAP of Image to Text: 0.851, MAP of Text to Image: 0.806
2022-12-19 02:20:40,530 - INFO - --------------------------------------------------------------------
2022-12-19 02:21:47,020 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-19 02:21:47,021 - INFO - MAP of Image to Text: 0.691, MAP of Text to Image: 0.727
2022-12-19 02:21:47,021 - INFO - --------------------------------------------------------------------
2022-12-19 02:21:47,400 - INFO - ---------------------------Test------------------------
2022-12-19 02:21:48,335 - INFO - **************** Load checkpoint ./checkpoint/ASCH_NUSWIDE_32_bit_best_epoch.pth ****************
2022-12-19 02:21:48,338 - INFO - ********** The loaded model has been trained for 80 epochs.*********
2022-12-19 02:30:06,452 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-19 02:30:06,453 - INFO - MAP of Image to Text: 0.7009, MAP of Text to Image: 0.7330
2022-12-19 02:30:06,453 - INFO - --------------------------------------------------------------------
2022-12-19 02:39:56,227 - INFO - tensor([0.8550, 0.8481, 0.8440, 0.8395, 0.8338, 0.8322, 0.8301, 0.8279, 0.8256,
        0.8230, 0.8207, 0.8178])
2022-12-19 02:39:56,232 - INFO - tensor([0.7960, 0.8086, 0.8089, 0.8067, 0.8064, 0.8055, 0.8052, 0.8040, 0.8035,
        0.8028, 0.8016, 0.8009])
2022-12-19 03:00:24,246 - INFO - tensor([0.8499, 0.8479, 0.8440, 0.8395, 0.8322, 0.8178, 0.8178, 0.7785, 0.7483,
        0.7120, 0.6767, 0.6496, 0.6260, 0.6024, 0.5810, 0.5592, 0.5362, 0.5123,
        0.4886, 0.4654, 0.4437, 0.4234, 0.4044, 0.3871, 0.3724])
2022-12-19 03:00:24,249 - INFO - tensor([8.6194e-04, 1.7143e-03, 8.4724e-03, 1.6787e-02, 3.2991e-02, 7.9508e-02,
        7.9508e-02, 2.1129e-01, 3.2558e-01, 4.1955e-01, 4.9791e-01, 5.7012e-01,
        6.3673e-01, 6.9551e-01, 7.4986e-01, 7.9785e-01, 8.3868e-01, 8.7247e-01,
        9.0045e-01, 9.2331e-01, 9.4306e-01, 9.6005e-01, 9.7435e-01, 9.8741e-01,
        1.0000e+00])
2022-12-19 03:00:24,251 - INFO - tensor([0.8071, 0.8079, 0.8089, 0.8067, 0.8055, 0.8009, 0.8009, 0.7756, 0.7569,
        0.7342, 0.7063, 0.6815, 0.6574, 0.6343, 0.6095, 0.5823, 0.5523, 0.5217,
        0.4935, 0.4682, 0.4451, 0.4238, 0.4046, 0.3873, 0.3724])
2022-12-19 03:00:24,252 - INFO - tensor([7.6582e-04, 1.5355e-03, 7.6605e-03, 1.5180e-02, 3.0284e-02, 7.4943e-02,
        7.4943e-02, 2.0621e-01, 3.2380e-01, 4.2466e-01, 5.0817e-01, 5.8351e-01,
        6.5152e-01, 7.1396e-01, 7.6921e-01, 8.1574e-01, 8.5226e-01, 8.7991e-01,
        9.0342e-01, 9.2421e-01, 9.4260e-01, 9.5840e-01, 9.7299e-01, 9.8672e-01,
        1.0000e+00])
2022-12-19 03:01:20,837 - INFO - --------------------Evaluation: Calculate top MAP-------------------
2022-12-19 03:01:20,839 - INFO - MAP of Image to Text: 0.8547, MAP of Text to Image: 0.8079
2022-12-19 03:01:20,840 - INFO - --------------------------------------------------------------------
